import{r as i,e as n,t as o,j as e,L as K}from"./app-CWiOuBar.js";import{S as X}from"./SellerLayout-D-XJhX72.js";import{B as j}from"./button-Dxm4Zo-h.js";import{I as y,L as d}from"./label-DJOi4cIA.js";import{B as P}from"./badge-BFTD5jQ5.js";import{D as Y,a as Z,b as $,c as ee,e as ae,d as se}from"./dialog-C7_lClPz.js";import{T as te}from"./textarea-xFgOSWZY.js";import{S as D,a as F,b as L,c as E,d as I}from"./select-CnAq2Yj9.js";import{D as re,a as ie,b as le,c as k}from"./dropdown-menu-_XKwrTlt.js";import{C as ce}from"./checkbox-tteav3Kx.js";import{S as oe}from"./search-DWlJk53U.js";import{L as T}from"./loader-circle-CvRf3XAX.js";import{P as de}from"./SellerSidebar-vrNB4XgO.js";import{E as ne,P as me}from"./pencil-DxWJ2GUQ.js";import{T as he}from"./trash-2-DrS9Ihmt.js";import"./createLucideIcon-BUxOv-G3.js";import"./index-B4dni2ra.js";import"./index-CUy8SzR8.js";import"./index-DEqCAKoJ.js";import"./tslib.es6-BUas5LQb.js";import"./index-CbP2wK5_.js";import"./index-Dyfk28tY.js";import"./index-BVvluDKG.js";import"./index-Df33P2d9.js";import"./auth-CXF110Ab.js";const Ae=()=>{const[B,M]=i.useState([]),[x,m]=i.useState(!0),[h,U]=i.useState(""),[A,p]=i.useState(!1),[b,f]=i.useState(null),[O,V]=i.useState([]),[R,Q]=i.useState([]),[N,g]=i.useState(null),[v,w]=i.useState(null),[t,c]=i.useState({name:"",description:"",category_id:"",brand_id:"",web_availability:!1});i.useEffect(()=>{u(),q(),z()},[]);const u=async()=>{try{m(!0);const a=await n.get("/api/products",{params:{with:"product",limit:1e3}});a.data.status==="success"&&M(a.data.data)}catch(a){console.error("Failed to fetch products",a),o.error("Failed to load products")}finally{m(!1)}},q=async()=>{try{const a=await n.get("/api/categories");a.data.status==="success"&&V(a.data.data)}catch(a){console.error("Error fetching categories:",a)}},z=async()=>{try{const a=await n.get("/api/brands");a.data.status==="success"&&Q(a.data.data)}catch(a){console.error("Error fetching brands:",a)}},H=a=>{f(a),c({name:a.name,description:a.description,category_id:a.category_id.toString(),brand_id:a.brand_id.toString(),web_availability:a.web_availability}),g(a.primary_image?"/"+a.primary_image:null),p(!0)},W=a=>{if(a.target.files&&a.target.files[0]){const r=a.target.files[0];w(r),g(URL.createObjectURL(r))}},G=async a=>{var r,l;if(a.preventDefault(),!!b){m(!0);try{const s=new FormData;s.append("id",b.id.toString()),s.append("name",t.name),s.append("description",t.description),s.append("category_id",t.category_id),s.append("brand_id",t.brand_id),s.append("web_availability",t.web_availability?"1":"0"),v&&s.append("primary_image",v);const _=await n.post("/api/products/update",s,{headers:{"Content-Type":"multipart/form-data"}});_.data.status==="success"?(o.success("Product updated successfully"),p(!1),u(),S()):o.error(_.data.message||"Failed to update product")}catch(s){console.error("Update error:",s),o.error(((l=(r=s.response)==null?void 0:r.data)==null?void 0:l.message)||"Failed to update product")}finally{m(!1)}}},J=async a=>{var r,l;if(confirm("Are you sure you want to delete this product? This action cannot be undone."))try{const s=await n.delete("/api/products",{data:{id:a}});s.data.status==="success"?(o.success("Product deleted successfully"),u()):o.error(s.data.errors||s.data.message||"Failed to delete product")}catch(s){console.error("Delete error:",s),o.error(((l=(r=s.response)==null?void 0:r.data)==null?void 0:l.errors)||"Failed to delete product")}},S=()=>{f(null),c({name:"",description:"",category_id:"",brand_id:"",web_availability:!1}),g(null),w(null)},C=B.filter(a=>a.name.toLowerCase().includes(h.toLowerCase())||a.description.toLowerCase().includes(h.toLowerCase()));return e.jsxs(X,{children:[e.jsx(K,{title:"Manage Products | Seller Center"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Manage Products"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Edit or delete your products"})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx(oe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(y,{placeholder:"Search products...",className:"pl-9 bg-white",value:h,onChange:a=>U(a.target.value)})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 font-medium border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3",children:"Product"}),e.jsx("th",{className:"px-6 py-3",children:"Category"}),e.jsx("th",{className:"px-6 py-3",children:"Brand"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:x?e.jsx("tr",{children:e.jsxs("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:[e.jsx(T,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"Loading products..."]})}):C.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500",children:[e.jsx(de,{className:"w-10 h-10 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium text-gray-900",children:"No products found"}),e.jsx("p",{children:h?"Try a different search term":"Create your first product to get started"})]})}):C.map(a=>{var r,l;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-16 w-16 flex-shrink-0 bg-gray-100 rounded-md overflow-hidden border border-gray-200",children:e.jsx("img",{src:a.primary_image?"/"+a.primary_image:"https://via.placeholder.com/64?text=No+Image",alt:a.name,className:"h-full w-full object-cover",onError:s=>{s.target.src="https://via.placeholder.com/64?text=No+Img"}})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:a.name}),e.jsx("div",{className:"text-gray-500 text-xs truncate max-w-xs",children:a.description})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(P,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:((r=a.category)==null?void 0:r.name)||"N/A"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(P,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-200",children:((l=a.brand)==null?void 0:l.name)||"N/A"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs(re,{children:[e.jsx(ie,{asChild:!0,children:e.jsx(j,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-500",children:e.jsx(ne,{className:"h-4 w-4"})})}),e.jsxs(le,{align:"end",className:"bg-white",children:[e.jsxs(k,{onClick:()=>H(a),children:[e.jsx(me,{className:"w-4 h-4 mr-2"})," Edit"]}),e.jsxs(k,{className:"text-red-600",onClick:()=>J(a.id),children:[e.jsx(he,{className:"w-4 h-4 mr-2"})," Delete"]})]})]})})]},a.id)})})]})})]})]}),e.jsx(Y,{open:A,onOpenChange:p,children:e.jsxs(Z,{className:"max-w-3xl bg-white",children:[e.jsxs($,{children:[e.jsx(ee,{children:"Edit Product"}),e.jsx(ae,{children:"Update the product details below."})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto py-4",children:e.jsxs("form",{id:"edit-product-form",onSubmit:G,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"image",children:"Product Image"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[N&&e.jsx("div",{className:"w-full h-40 bg-gray-100 rounded-md overflow-hidden border border-gray-200",children:e.jsx("img",{src:N,alt:"Preview",className:"w-full h-full object-cover"})}),e.jsx(y,{id:"image",type:"file",accept:"image/*",onChange:W,className:"cursor-pointer bg-white"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(d,{htmlFor:"name",children:"Product Name"}),e.jsx(y,{id:"name",required:!0,value:t.name,onChange:a=>c({...t,name:a.target.value}),placeholder:"Product Name",className:"bg-white"})]}),e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(d,{htmlFor:"description",children:"Description"}),e.jsx(te,{id:"description",value:t.description,onChange:a=>c({...t,description:a.target.value}),placeholder:"Product description...",className:"h-24 bg-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"category",children:"Category"}),e.jsxs(D,{value:t.category_id,onValueChange:a=>c({...t,category_id:a}),children:[e.jsx(F,{className:"bg-white",children:e.jsx(L,{placeholder:"Select category"})}),e.jsx(E,{className:"bg-white",children:O.map(a=>e.jsx(I,{value:a.id.toString(),children:a.name},a.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"brand",children:"Brand"}),e.jsxs(D,{value:t.brand_id,onValueChange:a=>c({...t,brand_id:a}),children:[e.jsx(F,{className:"bg-white",children:e.jsx(L,{placeholder:"Select brand"})}),e.jsx(E,{className:"bg-white",children:R.map(a=>e.jsx(I,{value:a.id.toString(),children:a.name},a.id))})]})]}),e.jsxs("div",{className:"col-span-2 flex items-center space-x-2",children:[e.jsx(ce,{id:"web_availability",checked:t.web_availability,onCheckedChange:a=>c({...t,web_availability:a}),className:"data-[state=checked]:bg-green-600 data-[state=checked]:border-green-600"}),e.jsx(d,{htmlFor:"web_availability",className:"text-sm font-medium cursor-pointer",children:"Available on Web Store"})]})]})]})}),e.jsxs(se,{children:[e.jsx(j,{variant:"outline",onClick:()=>{p(!1),S()},children:"Cancel"}),e.jsxs(j,{form:"edit-product-form",type:"submit",disabled:x,className:"bg-green-600 hover:bg-green-700 text-white",children:[x?e.jsx(T,{className:"w-4 h-4 animate-spin mr-2"}):null,"Update Product"]})]})]})})]})};export{Ae as default};
