import{r,t as n,j as e,L as i}from"./app-BSycSqpy.js";import{g as B,N as x,F as m,c as U,u as Y,r as G}from"./Footer-DZqWA5Aj.js";import{F as h,a as H,b as M,c as Q,d as V,e as X,f as z,g as J}from"./index-dS0WK6py.js";import"./logo-D38OwFmG.js";import"./auth-CS0j0hjE.js";const ae=()=>{const[c,C]=r.useState([]),[F,g]=r.useState(!0),[u,p]=r.useState(null),[_,S]=r.useState(!1),[I,$]=r.useState(0),[j,T]=r.useState(0),[P,q]=r.useState(0),[E,L]=r.useState(0);r.useEffect(()=>{const s=localStorage.getItem("token");S(!!s),s?d():g(!1)},[]);const d=async()=>{try{const s=await B();C(s.cart_items||[]),$(s.total_amount||0),T(s.total_discount||0),q(s.total_tax||0),L(s.grand_total||0)}catch(s){console.error("Error loading cart:",s),n.error("Failed to load cart")}finally{g(!1)}},b=async(s,t)=>{if(!(t<1)){p(s);try{await Y(s,t),await d(),n.success("Cart updated")}catch(a){console.error("Error updating cart:",a),n.error("Failed to update cart")}finally{p(null)}}},A=async s=>{try{await G(s),await d(),n.success("Item removed from cart")}catch(t){console.error("Error removing item:",t),n.error("Failed to remove item")}},D=async()=>{if(window.confirm("Are you sure you want to clear your cart?"))try{await U(),await d(),n.success("Cart cleared")}catch(s){console.error("Error clearing cart:",s),n.error("Failed to clear cart")}},f=s=>!s.stock.variation_stocks||s.stock.variation_stocks.length===0?"":s.stock.variation_stocks.map(t=>`${t.variation_option.variation.name}: ${t.variation_option.name}`).join(" â€¢ "),O=s=>{var a,l;if(s.stock.variation_stocks&&s.stock.variation_stocks.length>0){const o=s.stock.variation_stocks[0].image;if(o)return o.startsWith("http")||o.startsWith("/")?o:`/${o}`}const t=((l=(a=s.stock)==null?void 0:a.product)==null?void 0:l.primary_image)||"/placeholder-image.png";return t.startsWith("http")||t.startsWith("/")?t:`/${t}`},y=s=>{const t=s.stock.web_price,a=s.stock.web_discount;return t-t*a/100},R=s=>s.stock.web_price,W=s=>s.stock.web_discount>0;return F?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(x,{}),e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})}),e.jsx(m,{})]}):_?c.length===0?e.jsxs("div",{className:"min-h-screen bg-gray-50 font-sans",children:[e.jsx(x,{}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-12 text-center",children:[e.jsx(h,{className:"w-20 h-20 mx-auto text-gray-300 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Your Cart is Empty"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Add some products to get started!"}),e.jsxs(i,{href:"/products",className:"inline-flex items-center px-6 py-3 bg-green-600 text-white rounded-full hover:bg-green-700 transition-colors font-semibold",children:[e.jsx(H,{className:"w-5 h-5 mr-2"}),"Browse Products"]})]})}),e.jsx(m,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50 font-sans",children:[e.jsx(x,{}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("nav",{className:"flex text-sm text-gray-500 mb-6",children:[e.jsx(i,{href:"/",className:"hover:text-green-600",children:"Home"}),e.jsx("span",{className:"mx-2",children:"/"}),e.jsx("span",{className:"text-gray-900 font-medium",children:"Shopping Cart"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center",children:[e.jsx(h,{className:"mr-3 text-green-600"}),"Shopping Cart"]}),c.length>0&&e.jsxs("button",{onClick:D,className:"text-red-600 hover:text-red-700 text-sm font-medium flex items-center",children:[e.jsx(M,{className:"w-4 h-4 mr-1"}),"Clear Cart"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-gray-50 border-b border-gray-100",children:e.jsxs("p",{className:"text-sm font-semibold text-gray-700",children:[c.length," Item",c.length!==1?"s":""," in Cart"]})}),e.jsx("div",{className:"divide-y divide-gray-100",children:c.map(s=>{var t,a,l,o,N,v,w,k;return e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:O(s),alt:((a=(t=s.stock)==null?void 0:t.product)==null?void 0:a.name)||"Product",className:"w-24 h-24 object-cover rounded-lg border border-gray-200"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(i,{href:`/product/${((o=(l=s.stock)==null?void 0:l.product)==null?void 0:o.slug)||"#"}`,className:"text-lg font-semibold text-gray-900 hover:text-green-600 line-clamp-2",children:((v=(N=s.stock)==null?void 0:N.product)==null?void 0:v.name)||"Product Name"}),f(s)&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:f(s)}),((k=(w=s.stock)==null?void 0:w.product)==null?void 0:k.brand)&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Brand:"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.stock.product.brand.name})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs("span",{className:"text-xl font-bold text-green-600",children:["$",y(s).toFixed(2)]}),W(s)&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-sm text-gray-400 line-through",children:["$",R(s).toFixed(2)]}),e.jsxs("span",{className:"text-xs font-semibold text-red-600 bg-red-50 px-2 py-1 rounded",children:[s.stock.web_discount,"% OFF"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg overflow-hidden",children:[e.jsx("button",{onClick:()=>b(s.stock_id,s.quantity-1),disabled:s.quantity<=1||u===s.stock_id,className:"px-3 py-2 hover:bg-gray-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Q,{className:"w-4 h-4 text-gray-600"})}),e.jsx("span",{className:"px-4 py-2 font-semibold text-gray-900 min-w-[3rem] text-center",children:s.quantity}),e.jsx("button",{onClick:()=>b(s.stock_id,s.quantity+1),disabled:s.quantity>=s.stock.quantity||u===s.stock_id,className:"px-3 py-2 hover:bg-gray-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(V,{className:"w-4 h-4 text-gray-600"})})]}),e.jsxs("button",{onClick:()=>A(s.stock_id),className:"text-red-600 hover:text-red-700 flex items-center gap-1 text-sm font-medium",children:[e.jsx(X,{className:"w-4 h-4"}),"Remove"]})]}),s.stock.quantity<10&&e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-orange-600 text-sm",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsxs("span",{children:["Only ",s.stock.quantity," left in stock"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Subtotal"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900",children:["$",(y(s)*s.quantity).toFixed(2)]})]})]})},s.id)})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 sticky top-24",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Order Summary"}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex justify-between text-gray-700",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["$",I.toFixed(2)]})]}),j>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{className:"font-semibold",children:["-$",j.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-gray-700",children:[e.jsx("span",{children:"Tax (8%)"}),e.jsxs("span",{className:"font-semibold",children:["$",P.toFixed(2)]})]}),e.jsx("div",{className:"border-t border-gray-200 pt-3",children:e.jsxs("div",{className:"flex justify-between text-lg",children:[e.jsx("span",{className:"font-bold text-gray-900",children:"Total"}),e.jsxs("span",{className:"font-bold text-green-600",children:["$",E.toFixed(2)]})]})})]}),e.jsxs("button",{onClick:()=>window.location.href="/checkout/step1",className:"w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white font-bold py-4 rounded-full transition-all shadow-lg hover:shadow-xl flex items-center justify-center gap-2",children:["Proceed to Checkout",e.jsx(J,{className:"w-5 h-5"})]}),e.jsx(i,{href:"/products",className:"block w-full text-center text-green-600 hover:text-green-700 font-semibold py-3 mt-3",children:"Continue Shopping"})]})})]})]}),e.jsx(m,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50 font-sans",children:[e.jsx(x,{}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-12 text-center",children:[e.jsx(h,{className:"w-20 h-20 mx-auto text-gray-300 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Please Log In"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You need to be logged in to view your cart"}),e.jsx(i,{href:"/login?redirect_with=cart",className:"inline-flex items-center px-6 py-3 bg-green-600 text-white rounded-full hover:bg-green-700 transition-colors font-semibold",children:"Log In to Continue"})]})}),e.jsx(m,{})]})};export{ae as default};
