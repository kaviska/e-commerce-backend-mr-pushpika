import{r as a,j as e,t as V}from"./app-BevSkdG7.js";import{N as U,F as z}from"./Footer-CorOyyjV.js";import{c as X,P as G,Q as H,b as K,d as T,e as q}from"./QuickViewModal-BTDzFe8e.js";import{K as J,L as W,M as Y,s as R,e as M,C as Z}from"./index-Dc9H6sBh.js";import"./logo-D38OwFmG.js";import"./auth-BlSIcDT4.js";const ee=({min:u,max:m,step:x=1,value:N,onValueChange:w,className:E=""})=>{const[g,C]=a.useState(N),_=a.useRef(null),v=a.useRef(null);a.useEffect(()=>{C(N)},[N]);const f=a.useCallback(p=>(p-u)/(m-u)*100,[u,m]),k=p=>S=>{S.preventDefault(),v.current=p,document.addEventListener("mousemove",j),document.addEventListener("mouseup",F)},j=a.useCallback(p=>{if(!v.current||!_.current)return;const S=_.current.getBoundingClientRect(),l=Math.min(Math.max((p.clientX-S.left)/S.width,0),1);let h=Math.round((l*(m-u)+u)/x)*x;C(r=>{const y=[...r];return v.current==="min"?(h=Math.min(h,r[1]-x),y[0]=Math.max(h,u)):(h=Math.max(h,r[0]+x),y[1]=Math.min(h,m)),w(y),y})},[m,u,x,w]),F=a.useCallback(()=>{v.current=null,document.removeEventListener("mousemove",j),document.removeEventListener("mouseup",F)},[j]);return e.jsx("div",{className:`relative w-full h-6 flex items-center select-none ${E}`,children:e.jsxs("div",{ref:_,className:"relative w-full h-2 bg-gray-200 rounded-full",children:[e.jsx("div",{className:"absolute h-full bg-primary rounded-full",style:{left:`${f(g[0])}%`,width:`${f(g[1])-f(g[0])}%`}}),e.jsx("div",{className:"absolute w-5 h-5 bg-white border-2 border-primary rounded-full cursor-grab active:cursor-grabbing shadow-sm top-1/2 -translate-y-1/2 -translate-x-1/2 hover:scale-110 transition-transform",style:{left:`${f(g[0])}%`},onMouseDown:k("min")}),e.jsx("div",{className:"absolute w-5 h-5 bg-white border-2 border-primary rounded-full cursor-grab active:cursor-grabbing shadow-sm top-1/2 -translate-y-1/2 -translate-x-1/2 hover:scale-110 transition-transform",style:{left:`${f(g[1])}%`},onMouseDown:k("max")})]})})},ie=()=>{const[u,m]=a.useState(!1),[x,N]=a.useState("grid"),[w,E]=a.useState([]),[g,C]=a.useState(!0),[_,v]=a.useState(null),[f,k]=a.useState(!1),[j,F]=a.useState([]),[p,S]=a.useState([]),[l,h]=a.useState([]),[r,y]=a.useState([]),[d,O]=a.useState({}),[i,P]=a.useState(!1),[c,$]=a.useState(!1);a.useEffect(()=>{(async()=>{try{const[t,n]=await Promise.all([K(),T()]);t.status==="success"&&F(t.data),n.status==="success"&&S(n.data);const o=new URLSearchParams(window.location.search),b=o.getAll("category_ids[]").map(Number);b.length&&h(b);const Q=o.getAll("brand_ids[]").map(Number);Q.length&&y(Q);const I=o.get("web_price_min"),D=o.get("web_price_max");(I||D)&&O({min:I?Number(I):void 0,max:D?Number(D):void 0}),o.get("in_stock")==="1"&&P(!0),o.get("has_web_discount")==="1"&&$(!0)}catch(t){console.error("Error loading filter data:",t)}})()},[]),a.useEffect(()=>{(async()=>{try{C(!0);const t=new URLSearchParams;l.forEach(b=>t.append("category_ids[]",b.toString())),r.forEach(b=>t.append("brand_ids[]",b.toString())),d.min&&t.append("web_price_min",d.min.toString()),d.max&&t.append("web_price_max",d.max.toString()),i&&t.append("in_stock","1"),c&&t.append("has_web_discount","1");const n=`${window.location.pathname}?${t.toString()}`;window.history.replaceState({},"",n);const o=await q({category_ids:l,brand_ids:r,web_price_min:d.min,web_price_max:d.max,in_stock:i,has_web_discount:c});o.status==="success"?E(o.data):V.error("Failed to load products")}catch(t){console.error("Error fetching products:",t),V.error("An error occurred while loading products")}finally{C(!1)}})()},[l,r,d,i,c]);const L=s=>{h(t=>t.includes(s)?t.filter(n=>n!==s):[...t,s])},A=s=>{y(t=>t.includes(s)?t.filter(n=>n!==s):[...t,s])},B=()=>{h([]),y([]),O({}),P(!1),$(!1)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 font-sans",children:[e.jsx(U,{}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-500 mb-4",children:[e.jsx("span",{className:"hover:text-primary cursor-pointer",children:"Home"}),e.jsx("span",{className:"mx-2",children:"/"}),e.jsx("span",{className:"text-gray-900 font-medium",children:"All Products"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"All Products"}),e.jsx("p",{className:"text-gray-500 mt-1",children:g?"Loading products...":`Showing ${w.length} products`})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{className:"md:hidden flex items-center px-4 py-2 bg-white border border-gray-200 rounded-lg text-gray-700 hover:bg-gray-50",onClick:()=>m(!0),children:[e.jsx(J,{className:"mr-2"}),"Filters"]}),e.jsxs("div",{className:"hidden md:flex bg-white border border-gray-200 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>N("grid"),className:`p-2 rounded ${x==="grid"?"bg-gray-100 text-primary":"text-gray-400 hover:text-gray-600"}`,children:e.jsx(W,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>N("list"),className:`p-2 rounded ${x==="list"?"bg-gray-100 text-primary":"text-gray-400 hover:text-gray-600"}`,children:e.jsx(Y,{className:"w-5 h-5"})})]})]})]})]}),e.jsxs("div",{className:"flex gap-8",children:[e.jsxs("aside",{className:"hidden lg:block w-64 flex-shrink-0 space-y-8",children:[(l.length>0||r.length>0||i||c)&&e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"font-bold text-gray-900",children:"Active Filters"}),e.jsx("button",{onClick:B,className:"text-xs text-red-500 hover:underline",children:"Clear All"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[i&&e.jsx("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:"In Stock"}),c&&e.jsx("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:"On Sale"}),l.length>0&&e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:[l.length," Categories"]}),r.length>0&&e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:[r.length," Brands"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Categories"}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-2 custom-scrollbar",children:j.map(s=>e.jsxs("label",{className:"flex items-center group cursor-pointer",children:[e.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${l.includes(s.id)?"bg-primary border-primary":"border-gray-300 bg-white"}`,children:l.includes(s.id)&&e.jsx(R,{className:"w-3 h-3 text-white"})}),e.jsx("input",{type:"checkbox",className:"hidden",checked:l.includes(s.id),onChange:()=>L(s.id)}),e.jsx("span",{className:`ml-3 text-sm transition-colors ${l.includes(s.id)?"text-primary font-medium":"text-gray-600 group-hover:text-primary"}`,children:s.name})]},s.id))})]}),e.jsx("div",{className:"h-px bg-gray-200"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Price Range"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["$",d.min??0," - $",d.max??5e3]})]}),e.jsx("div",{className:"px-2",children:e.jsx(ee,{min:0,max:5e3,step:10,value:[d.min??0,d.max??5e3],onValueChange:([s,t])=>O({min:s,max:t})})})]}),e.jsx("div",{className:"h-px bg-gray-200"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Status"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center group cursor-pointer",children:[e.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${i?"bg-primary border-primary":"border-gray-300 bg-white"}`,children:i&&e.jsx(R,{className:"w-3 h-3 text-white"})}),e.jsx("input",{type:"checkbox",className:"hidden",checked:i,onChange:()=>P(!i)}),e.jsx("span",{className:"ml-3 text-sm text-gray-600 group-hover:text-primary",children:"In Stock Only"})]}),e.jsxs("label",{className:"flex items-center group cursor-pointer",children:[e.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${c?"bg-primary border-primary":"border-gray-300 bg-white"}`,children:c&&e.jsx(R,{className:"w-3 h-3 text-white"})}),e.jsx("input",{type:"checkbox",className:"hidden",checked:c,onChange:()=>$(!c)}),e.jsx("span",{className:"ml-3 text-sm text-gray-600 group-hover:text-primary",children:"On Sale"})]})]})]}),e.jsx("div",{className:"h-px bg-gray-200"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Brands"}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-2 custom-scrollbar",children:p.map(s=>e.jsxs("label",{className:"flex items-center group cursor-pointer",children:[e.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${r.includes(s.id)?"bg-primary border-primary":"border-gray-300 bg-white"}`,children:r.includes(s.id)&&e.jsx(R,{className:"w-3 h-3 text-white"})}),e.jsx("input",{type:"checkbox",className:"hidden",checked:r.includes(s.id),onChange:()=>A(s.id)}),e.jsx("span",{className:`ml-3 text-sm transition-colors ${r.includes(s.id)?"text-primary font-medium":"text-gray-600 group-hover:text-primary"}`,children:s.name})]},s.id))})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-6",children:[l.map(s=>{const t=j.find(n=>n.id===s);return t?e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-gray-200 text-gray-700",children:[t.name,e.jsx("button",{onClick:()=>L(s),className:"ml-2 hover:text-red-500",children:e.jsx(M,{className:"w-3 h-3"})})]},s):null}),r.map(s=>{const t=p.find(n=>n.id===s);return t?e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-gray-200 text-gray-700",children:[t.name,e.jsx("button",{onClick:()=>A(s),className:"ml-2 hover:text-red-500",children:e.jsx(M,{className:"w-3 h-3"})})]},s):null}),i&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-gray-200 text-gray-700",children:["In Stock",e.jsx("button",{onClick:()=>P(!1),className:"ml-2 hover:text-red-500",children:e.jsx(M,{className:"w-3 h-3"})})]}),c&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-gray-200 text-gray-700",children:["On Sale",e.jsx("button",{onClick:()=>$(!1),className:"ml-2 hover:text-red-500",children:e.jsx(M,{className:"w-3 h-3"})})]}),(l.length>0||r.length>0||i||c)&&e.jsx("button",{onClick:B,className:"text-sm text-primary hover:underline ml-2",children:"Clear All"})]}),g?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(Z,{className:"w-10 h-10 text-primary animate-spin"})}):e.jsx("div",{className:`grid ${x==="grid"?"grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5":"grid-cols-1"} gap-4`,children:w.map(s=>{var o,b;const t=X(s.stocks),n={id:s.id,name:s.name,slug:s.slug,image:s.primary_image||"https://via.placeholder.com/300",images:[s.primary_image],price:t.price,originalPrice:t.originalPrice,rating:s.reviews_avg_rating||0,reviewCount:s.reviews_count||0,category:((o=s.category)==null?void 0:o.name)||"Uncategorized",brand:(b=s.brand)==null?void 0:b.name,inStock:t.inStock,stockCount:t.stockCount,isOnSale:(t.discount||0)>0,isBestSeller:!1,isNew:!1,freeShipping:!1,description:s.description,discount:t.discount,discountPercentage:t.discountPercentage,priceRange:t.priceRange,originalPriceRange:t.originalPriceRange};return e.jsx(G,{product:n,variant:x==="grid"?"compact":"detailed",onQuickView:()=>{v(n),k(!0)}},s.id)})}),!g&&w.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500 text-lg",children:"No products found matching your filters."}),e.jsx("button",{onClick:B,className:"mt-4 text-primary hover:underline font-medium",children:"Clear Filters"})]})]})]})]}),u&&e.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>m(!1)}),e.jsxs("div",{className:"absolute right-0 top-0 bottom-0 w-80 bg-white shadow-xl p-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Filters"}),e.jsx("button",{onClick:()=>m(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(M,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Categories"}),e.jsx("div",{className:"space-y-2",children:j.map(s=>e.jsxs("label",{className:"flex items-center group",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary",checked:l.includes(s.id),onChange:()=>L(s.id)}),e.jsx("span",{className:"ml-3 text-gray-600",children:s.name})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Status"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center group",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary",checked:i,onChange:()=>P(!i)}),e.jsx("span",{className:"ml-3 text-gray-600",children:"In Stock Only"})]}),e.jsxs("label",{className:"flex items-center group",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary",checked:c,onChange:()=>$(!c)}),e.jsx("span",{className:"ml-3 text-gray-600",children:"On Sale"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Brands"}),e.jsx("div",{className:"space-y-2",children:p.map(s=>e.jsxs("label",{className:"flex items-center group",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary",checked:r.includes(s.id),onChange:()=>A(s.id)}),e.jsx("span",{className:"ml-3 text-gray-600",children:s.name})]},s.id))})]})]}),e.jsx("div",{className:"mt-8 pt-6 border-t border-gray-200",children:e.jsx("button",{className:"w-full bg-primary text-white py-3 rounded-xl font-semibold hover:bg-primary-600 transition-colors",onClick:()=>m(!1),children:"Apply Filters"})})]})]}),e.jsx(H,{isOpen:f,onClose:()=>k(!1),product:_,onAddToCart:s=>{V.success(`Added product ${s} to cart`),k(!1)}}),e.jsx(z,{})]})};export{ie as default};
