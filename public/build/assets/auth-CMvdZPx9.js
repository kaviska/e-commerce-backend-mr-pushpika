import{f as S,a as y}from"./app-qpV6NWqw.js";const c=S.create({baseURL:"/api",timeout:1e5,headers:{"Content-Type":"application/json",Accept:"application/json"}});c.interceptors.request.use(e=>{var s;const r=localStorage.getItem("token"),a=localStorage.getItem("user");return a&&((s=JSON.parse(a))==null||s.id),r&&(e.headers.Authorization=`Bearer ${r}`),e});c.interceptors.response.use(e=>e,e=>{var r;return((r=e.response)==null?void 0:r.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("user-token"),y.visit("/login")),Promise.reject(e)});const k=async(e,r,a)=>{var s,t,o,u,g,d;try{const n=await c.post("/login",{email:e,password:r,device_name:a}),i=(s=n.data.data)==null?void 0:s.token,p=(t=n.data.data)==null?void 0:t.user;return p&&localStorage.setItem("user",JSON.stringify(p)),i&&localStorage.setItem("token",i),{success:!0,data:n.data}}catch(n){return{success:!1,error:((u=(o=n.response)==null?void 0:o.data)==null?void 0:u.errors)||((d=(g=n.response)==null?void 0:g.data)==null?void 0:d.message)||"Login failed"}}},v=async(e,r,a,s,t,o)=>{var u,g,d,n,i,p;try{const l=await c.post("/register",{name:e,email:r,mobile:a,password:s,password_confirmation:t,device_name:o}),m=(u=l.data.data)==null?void 0:u.token,f=(g=l.data.data)==null?void 0:g.user;return m&&localStorage.setItem("token",m),f&&localStorage.setItem("user",JSON.stringify(f)),{success:!0,data:l.data}}catch(l){return{success:!1,error:((n=(d=l.response)==null?void 0:d.data)==null?void 0:n.errors)||((p=(i=l.response)==null?void 0:i.data)==null?void 0:p.message)||"Registration failed"}}},M=async e=>{var r,a,s,t;try{return{success:!0,data:(await c.post("/verify-otp",{otp:e})).data}}catch(o){return{success:!1,error:((a=(r=o.response)==null?void 0:r.data)==null?void 0:a.errors)||((t=(s=o.response)==null?void 0:s.data)==null?void 0:t.message)||"OTP verification failed"}}},h=async()=>{var e,r,a,s;try{return{success:!0,data:(await c.put("/resend-otp")).data}}catch(t){return{success:!1,error:((r=(e=t.response)==null?void 0:e.data)==null?void 0:r.errors)||((s=(a=t.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to resend OTP"}}},O=async()=>{var e,r,a,s;try{const t=await c.get("/logout");return localStorage.removeItem("token"),localStorage.removeItem("user"),{success:!0,data:t.data}}catch(t){return localStorage.removeItem("token"),localStorage.removeItem("user"),{success:!1,error:((r=(e=t.response)==null?void 0:e.data)==null?void 0:r.errors)||((s=(a=t.response)==null?void 0:a.data)==null?void 0:s.message)||"Logout failed"}}};export{c as a,v as b,O as c,k as l,h as r,M as v};
