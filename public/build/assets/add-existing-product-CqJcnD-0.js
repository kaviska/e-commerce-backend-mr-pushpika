import{r as n,j as e,t as i,e as ge,L as pe}from"./app-CWiOuBar.js";import{S as ue}from"./SellerLayout-D-XJhX72.js";import{d as be,e as fe,f as ye,g as je,a as ve,c as Ne}from"./seller-EGUTzyBc.js";import{B as m}from"./button-Dxm4Zo-h.js";import{L as x,I as f}from"./label-DJOi4cIA.js";import{D as ie,a as ne,b as le,c as oe,e as xe,d as ce}from"./dialog-C7_lClPz.js";import{C as we}from"./checkbox-tteav3Kx.js";import{T as _e}from"./textarea-xFgOSWZY.js";import{a as te}from"./auth-CXF110Ab.js";import{P as W,a as G,I as Z,L as re}from"./SellerSidebar-vrNB4XgO.js";import{c as de}from"./createLucideIcon-BUxOv-G3.js";import{X as Y}from"./index-CUy8SzR8.js";import{C as K}from"./index-Dyfk28tY.js";import{C as Se}from"./circle-alert-BJOEGb6o.js";import{T as Ce}from"./trash-2-DrS9Ihmt.js";import{S as ke,a as Ve,b as Pe,c as Fe,d as Ie}from"./select-CnAq2Yj9.js";import{S as De}from"./search-DWlJk53U.js";import{L as Le}from"./loader-circle-CvRf3XAX.js";import{A as Ee}from"./arrow-right-KHyXVs0h.js";import"./dropdown-menu-_XKwrTlt.js";import"./index-CbP2wK5_.js";import"./index-B4dni2ra.js";import"./index-Df33P2d9.js";import"./index-DEqCAKoJ.js";import"./tslib.es6-BUas5LQb.js";import"./index-BVvluDKG.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Te=de("FileText",Oe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],qe=de("PenLine",Be);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]],Me=de("Type",ze),$e=({isOpen:I,onClose:w,product:r,onSuccess:D,setIsVariationModalOpen:y,setIsBrandModalOpen:T,groupedVariations:_=[],brands:L=[],categories:B=[],isNew:E=!0})=>{var P,z,Q,J;const[u,k]=n.useState("no"),[d,S]=n.useState([]),[c,V]=n.useState(0),[b,A]=n.useState(!1),[p,C]=n.useState({name:"",description:"",brand_id:0,category_id:0,primary_image:[]}),[g,N]=n.useState({quantity:0,web_price:0,web_discount:0,images:[]}),[l,j]=n.useState({selectedVariations:[],quantity:0,web_price:0,web_discount:0,images:[]}),[U,q]=n.useState(null),[H,$]=n.useState(null),[X,R]=n.useState(null);n.useEffect(()=>{var a,t;r&&I&&(k("no"),A(!1),C({name:r.name||"",description:r.description||"",brand_id:((a=r.brand)==null?void 0:a.id)||0,category_id:((t=r.category)==null?void 0:t.id)||0,primary_image:[]}),N({quantity:0,web_price:r.web_price||0,web_discount:0,images:[]}),S([]),j({selectedVariations:[],quantity:0,web_price:r.web_price||0,web_discount:0,images:[]}),q(null),$(null),R(null))},[r,I]);const ee=async()=>{var h,F,me;if(!r)return;const a=localStorage.getItem("user"),t=(a?(h=JSON.parse(a))==null?void 0:h.id:null)||1;try{let M;if(E){const o=new FormData;if(o.append("name",p.name),o.append("description",p.description),o.append("category_id",p.category_id.toString()),o.append("brand_id",p.brand_id.toString()),o.append("user_id",t.toString()),p.primary_image.length>0)o.append("primary_image",p.primary_image[0]);else{i.error("Please upload a primary product image");return}i.loading("Creating product...");const v=await te.post("/products",o,{headers:{"Content-Type":"multipart/form-data"}});if(v.data.status!=="success"){i.dismiss(),i.error("Failed to create product");return}M=v.data.data.id}else M=r.id;if(i.dismiss(),i.loading("Adding stock..."),u==="no"){if(g.quantity<=0){i.dismiss(),i.error("Please enter a valid quantity");return}const o=new FormData;o.append("product_id",M.toString()),o.append("quantity",g.quantity.toString()),o.append("web_price",g.web_price.toString()),o.append("pos_price","0"),o.append("web_discount",g.web_discount.toString()),o.append("pos_discount","0"),o.append("variations[]","1"),o.append("user_id",t.toString()),g.images.length>0&&o.append("variation_images[]",g.images[0]),await te.post("/stocks",o,{headers:{"Content-Type":"multipart/form-data"}}),i.dismiss(),i.success("Product and stock added successfully"),D(),w()}else{if(d.length===0){i.dismiss(),i.error("Please add at least one variation stock");return}for(const o of d){const v=new FormData;v.append("product_id",M.toString()),v.append("quantity",o.quantity.toString()),v.append("web_price",o.web_price.toString()),v.append("pos_price","0"),v.append("web_discount",o.web_discount.toString()),v.append("pos_discount","0"),v.append("user_id",t.toString()),o.selectedVariations.forEach(he=>{v.append("variations[]",he.toString())}),o.images.length>0&&v.append("variation_images[]",o.images[0]),await te.post("/stocks",v,{headers:{"Content-Type":"multipart/form-data"}})}i.dismiss(),i.success(`Product created with ${d.length} stock variant(s)`),D(),w()}}catch(M){i.dismiss(),console.error("Error adding product/stock:",M),i.error(((me=(F=M.response)==null?void 0:F.data)==null?void 0:me.message)||"Failed to add product/stock")}},se=()=>{if(l.selectedVariations.length===0){i.error("Please select at least one variation option");return}if(l.quantity<=0){i.error("Please enter a valid quantity");return}if(d.some(h=>h.selectedVariations.length===l.selectedVariations.length&&h.selectedVariations.every(F=>l.selectedVariations.includes(F)))){i.error("This variation combination already exists");return}const t={id:Date.now().toString(),...l};S([...d,t]),j({selectedVariations:[],quantity:0,web_price:(r==null?void 0:r.web_price)||0,web_discount:0,images:[]}),R(null),V(h=>h+1),i.success("Variation stock added to list")},ae=a=>{S(d.filter(t=>t.id!==a)),i.info("Variation stock removed")},s=a=>{j(t=>t.selectedVariations.includes(a)?{...t,selectedVariations:t.selectedVariations.filter(F=>F!==a)}:{...t,selectedVariations:[...t.selectedVariations,a]})},O=a=>{const t=[];return _.forEach(h=>{h.options.forEach(F=>{a.includes(F.id)&&t.push(F.name)})}),t.join(" + ")};return e.jsx(ie,{open:I,onOpenChange:w,children:e.jsxs(ne,{className:"sm:max-w-[1000px] max-h-[95vh] flex flex-col p-0 gap-0 rounded-2xl bg-white",children:[e.jsx(le,{className:"p-6 pb-4 border-b bg-gradient-to-r from-green-50 via-emerald-50 to-teal-50 shrink-0",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsxs(oe,{className:"text-2xl flex items-center gap-2",children:[e.jsx(W,{className:"h-6 w-6 text-green-600"}),"Add Stock to Inventory"]}),e.jsxs(xe,{className:"text-gray-600 mt-1",children:["Configure product details and inventory for ",e.jsx("span",{className:"font-semibold text-gray-900",children:r==null?void 0:r.name})]})]})})}),e.jsxs("div",{className:"p-6 space-y-6 bg-white overflow-y-auto flex-1",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-200 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white/50 backdrop-blur-sm border-b border-blue-200",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5 text-blue-600"}),"Product Details"]}),E&&e.jsxs(m,{variant:"ghost",size:"sm",onClick:()=>A(!b),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-100 h-8",children:[e.jsx(qe,{className:"h-3.5 w-3.5 mr-1.5"}),b?"View Mode":"Edit Product"]})]}),e.jsx("div",{className:"p-5 space-y-4",children:b?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(x,{className:"text-xs font-semibold text-gray-700",children:"Product Name"}),e.jsx(f,{placeholder:"Enter product name",className:"h-11 bg-white border-blue-200 focus:border-blue-500 focus:ring-blue-500",value:p.name,onChange:a=>C({...p,name:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{className:"text-xs font-semibold text-gray-700",children:"Brand"}),e.jsxs(m,{type:"button",variant:"ghost",size:"sm",onClick:()=>T(!0),className:"text-blue-600 hover:text-blue-700 hover:bg-blue-100 h-7 text-xs font-semibold -mt-1",children:[e.jsx(G,{className:"h-3.5 w-3.5 mr-1"}),"Add Brand"]})]}),e.jsx("div",{className:"[&_button]:h-11 [&_button]:bg-white [&_button]:border-blue-200 [&_button]:hover:bg-blue-50",children:e.jsx(FormGenerator,{name:"brand_id",label:"",type:"selector",value:((Q=p.brand_id)==null?void 0:Q.toString())||"",onChange:a=>C({...p,brand_id:parseInt(a.target.value)}),selectOptions:L})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{className:"text-xs font-semibold text-gray-700",children:"Category"}),e.jsx("div",{className:"[&_button]:h-11 [&_button]:bg-white [&_button]:border-blue-200 [&_button]:hover:bg-blue-50",children:e.jsx(FormGenerator,{name:"category_id",label:"",type:"selector",value:((J=p.category_id)==null?void 0:J.toString())||"",onChange:a=>C({...p,category_id:parseInt(a.target.value)}),selectOptions:B})})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(x,{className:"text-xs font-semibold text-gray-700",children:"Description (Optional)"}),e.jsx(_e,{placeholder:"Enter product description...",className:"min-h-[80px] bg-white border-blue-200 focus:border-blue-500 focus:ring-blue-500",value:p.description,onChange:a=>C({...p,description:a.target.value})})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsxs(x,{className:"text-xs font-semibold text-gray-700 flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-blue-600"}),"Primary Product Image (Optional)"]}),e.jsxs("div",{className:"bg-white rounded-lg border border-blue-200 p-3 space-y-3",children:[e.jsx(f,{type:"file",accept:"image/*",onChange:a=>{var h;const t=(h=a.target.files)==null?void 0:h[0];t&&(C({...p,primary_image:[t]}),q(URL.createObjectURL(t)))},className:"cursor-pointer file:cursor-pointer file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),U&&e.jsxs("div",{className:"relative w-32 h-32 rounded-lg overflow-hidden border border-gray-200",children:[e.jsx("img",{src:U,alt:"Preview",className:"w-full h-full object-cover"}),e.jsx(m,{type:"button",variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-6 w-6 bg-white/80 hover:bg-white rounded-full",onClick:()=>{C({...p,primary_image:[]}),q(null)},children:e.jsx(Y,{className:"h-4 w-4 text-gray-500"})})]})]})]})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100 shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-1",children:"Product Name"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:r==null?void 0:r.name})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100 shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-1",children:"Brand"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:((P=r==null?void 0:r.brand)==null?void 0:P.name)||"No Brand"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100 shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-1",children:"Category"}),e.jsx("p",{className:"text-base font-semibold text-gray-900",children:((z=r==null?void 0:r.category)==null?void 0:z.name)||"Uncategorized"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100 shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-1",children:"Base Price"}),e.jsxs("p",{className:"text-base font-semibold text-green-600",children:["$",(r==null?void 0:r.web_price)||"0.00"]})]}),(r==null?void 0:r.description)&&e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-blue-100 shadow-sm md:col-span-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider mb-1",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:r.description})]})]})})]}),e.jsx("div",{className:"h-px bg-gradient-to-r from-transparent via-gray-300 to-transparent"}),e.jsxs("div",{className:"space-y-3 bg-gray-50 p-4 rounded-lg border border-gray-200",children:[e.jsx(x,{className:"text-sm font-semibold text-gray-900",children:"Does this product have variations?"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(m,{type:"button",variant:u==="no"?"default":"outline",className:`flex-1 h-11 ${u==="no"?"bg-green-600 hover:bg-green-700":"hover:bg-gray-50"}`,onClick:()=>{k("no"),S([])},children:[u==="no"&&e.jsx(K,{className:"h-4 w-4 mr-2"}),"No variations"]}),e.jsxs(m,{type:"button",variant:u==="yes"?"default":"outline",className:`flex-1 h-11 ${u==="yes"?"bg-green-600 hover:bg-green-700":"hover:bg-gray-50"}`,onClick:()=>{k("yes"),S([])},children:[u==="yes"&&e.jsx(K,{className:"h-4 w-4 mr-2"}),"Has variations"]})]}),e.jsxs("p",{className:"text-xs text-gray-500 flex items-start gap-1.5",children:[e.jsx(Se,{className:"h-3.5 w-3.5 mt-0.5 shrink-0"}),'Select "Has variations" if your product comes in different colors, sizes, or other options']})]}),u==="no"?e.jsxs("div",{className:"space-y-5 bg-gradient-to-br from-gray-50 to-slate-50 p-5 rounded-xl border border-gray-200",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-green-600"}),"Stock Configuration"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["Quantity ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(f,{type:"number",min:"0",placeholder:"100",className:"h-11 bg-white border-gray-300 focus:border-green-500 focus:ring-green-500 font-medium",value:g.quantity||"",onChange:a=>N({...g,quantity:parseInt(a.target.value)||0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["Price ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-semibold",children:"$"}),e.jsx(f,{type:"number",min:"0",step:"0.01",placeholder:"99.99",className:"pl-8 h-11 bg-white border-gray-300 focus:border-green-500 focus:ring-green-500 font-medium",value:g.web_price||"",onChange:a=>N({...g,web_price:parseFloat(a.target.value)||0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{className:"text-xs font-semibold text-gray-700",children:"Discount"}),e.jsxs("div",{className:"relative",children:[e.jsx(f,{type:"number",min:"0",max:"100",placeholder:"10",className:"pr-8 h-11 bg-white border-gray-300 focus:border-green-500 focus:ring-green-500 font-medium",value:g.web_discount||"",onChange:a=>N({...g,web_discount:parseFloat(a.target.value)||0})}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 font-medium"})]})]})]}),g.web_discount>0&&g.web_price>0&&e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-300 rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-green-700 uppercase tracking-wider",children:"Final Price After Discount"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600 mt-1",children:["$",(g.web_price*(1-g.web_discount/100)).toFixed(2)]})]}),e.jsxs("div",{className:"bg-green-600 text-white px-3 py-1 rounded-full text-sm font-bold",children:[g.web_discount," OFF"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{className:"text-xs font-semibold text-gray-700 flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-gray-600"}),"Product Image (Optional)"]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-3 space-y-3",children:[e.jsx(f,{type:"file",accept:"image/*",onChange:a=>{var h;const t=(h=a.target.files)==null?void 0:h[0];t&&(N({...g,images:[t]}),$(URL.createObjectURL(t)))},className:"cursor-pointer file:cursor-pointer file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100"}),H&&e.jsxs("div",{className:"relative w-32 h-32 rounded-lg overflow-hidden border border-gray-200",children:[e.jsx("img",{src:H,alt:"Preview",className:"w-full h-full object-cover"}),e.jsx(m,{type:"button",variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-6 w-6 bg-white/80 hover:bg-white rounded-full",onClick:()=>{N({...g,images:[]}),$(null)},children:e.jsx(Y,{className:"h-4 w-4 text-gray-500"})})]})]})]})]}):e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-4 bg-white p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4 text-green-600"}),"Select Variation Options"]}),e.jsxs(m,{variant:"ghost",size:"sm",onClick:()=>y(!0),className:"text-green-600 hover:text-green-700 hover:bg-green-50 h-7 text-xs",children:[e.jsx(G,{className:"h-3 w-3 mr-1"}),"Create New"]})]}),_.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:_.map(a=>e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-700 mb-2 uppercase tracking-wider",children:a.variation_name}),e.jsx("div",{className:"space-y-1.5 max-h-[120px] overflow-y-auto",children:a.options.map(t=>e.jsxs("label",{className:`flex items-center space-x-2 p-2 rounded-md transition-all cursor-pointer ${l.selectedVariations.includes(t.id)?"bg-green-100 border border-green-300":"bg-white hover:bg-gray-100 border border-transparent"}`,children:[e.jsx(we,{id:`var-${t.id}`,checked:l.selectedVariations.includes(t.id),onCheckedChange:()=>s(t.id),className:"data-[state=checked]:bg-green-600 data-[state=checked]:border-green-600"}),e.jsx("span",{className:"text-sm text-gray-700 font-medium",children:t.name})]},t.id))})]},a.variation_id))}):e.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:[e.jsx(re,{className:"h-8 w-8 text-gray-300 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"No variation options available"}),e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>y(!0),className:"text-green-600 border-green-600 hover:bg-green-50",children:[e.jsx(G,{className:"h-3 w-3 mr-1"}),"Create variation"]})]})]}),e.jsxs("div",{className:"space-y-4 bg-gradient-to-br from-gray-50 to-slate-50 p-5 rounded-xl border border-gray-200",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-green-600"}),"Stock Configuration for Selected Variations"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["Quantity ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(f,{type:"number",min:"0",placeholder:"50",className:"h-11 bg-white border-gray-300 focus:border-green-500 focus:ring-green-500 font-medium",value:l.quantity||"",onChange:a=>j({...l,quantity:parseInt(a.target.value)||0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{className:"text-xs font-semibold text-gray-700 flex items-center gap-1",children:["Price ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-semibold",children:"$"}),e.jsx(f,{type:"number",min:"0",step:"0.01",placeholder:"99.99",className:"pl-8 h-11 bg-white border-gray-300 focus:border-green-500 focus:ring-green-500 font-medium",value:l.web_price||"",onChange:a=>j({...l,web_price:parseFloat(a.target.value)||0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{className:"text-xs font-semibold text-gray-700",children:"Discount (%)"}),e.jsxs("div",{className:"relative",children:[e.jsx(f,{type:"number",min:"0",max:"100",placeholder:"10",className:"pr-8 h-11 bg-white border-gray-300 focus:border-green-500 focus:ring-green-500 font-medium",value:l.web_discount||"",onChange:a=>j({...l,web_discount:parseFloat(a.target.value)||0})}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 font-medium"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{className:"text-xs font-semibold text-gray-700 flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-gray-600"}),"Variation Image (Optional)"]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-300 p-3 space-y-3",children:[e.jsx(f,{type:"file",accept:"image/*",onChange:a=>{var h;const t=(h=a.target.files)==null?void 0:h[0];t&&(j({...l,images:[t]}),R(URL.createObjectURL(t)))},className:"cursor-pointer file:cursor-pointer file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100"},c),X&&e.jsxs("div",{className:"relative w-32 h-32 rounded-lg overflow-hidden border border-gray-200",children:[e.jsx("img",{src:X,alt:"Preview",className:"w-full h-full object-cover"}),e.jsx(m,{type:"button",variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-6 w-6 bg-white/80 hover:bg-white rounded-full",onClick:()=>{j({...l,images:[]}),R(null)},children:e.jsx(Y,{className:"h-4 w-4 text-gray-500"})})]})]})]}),e.jsxs(m,{onClick:se,className:"w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white h-12 text-base font-semibold shadow-lg shadow-green-200",disabled:l.selectedVariations.length===0,children:[e.jsx(G,{className:"h-5 w-5 mr-2"}),"Add This Variation to List"]})]}),d.length>0&&e.jsxs("div",{className:"space-y-4 bg-gradient-to-br from-green-50 via-emerald-50 to-teal-50 p-5 rounded-xl border-2 border-green-300 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-base font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-green-600"}),"Added Variations (",d.length,")"]}),e.jsxs("div",{className:"bg-green-600 text-white px-3 py-1 rounded-full text-xs font-bold",children:[d.length," Stock",d.length!==1?"s":""," Ready"]})]}),e.jsx("div",{className:"space-y-3 max-h-[350px] overflow-y-auto pr-2",children:d.map(a=>e.jsx("div",{className:"bg-white rounded-xl p-4 border-2 border-green-200 shadow-md hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-start gap-4",children:[a.images.length>0&&e.jsx("div",{className:"shrink-0",children:e.jsx("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden border-2 border-gray-200 shadow-sm",children:e.jsx("img",{src:URL.createObjectURL(a.images[0]),alt:"Variation",className:"w-full h-full object-cover"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-base text-gray-900 truncate mb-2",children:O(a.selectedVariations)}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("span",{className:"bg-gradient-to-r from-blue-100 to-indigo-100 text-blue-700 px-3 py-1 rounded-full text-xs font-semibold border border-blue-200",children:["Qty: ",a.quantity]}),e.jsxs("span",{className:"bg-gradient-to-r from-green-100 to-emerald-100 text-green-700 px-3 py-1 rounded-full text-xs font-semibold border border-green-200",children:["$",a.web_price]}),a.web_discount>0&&e.jsxs("span",{className:"bg-gradient-to-r from-orange-100 to-red-100 text-red-700 px-3 py-1 rounded-full text-xs font-semibold border border-red-200",children:[a.web_discount," OFF"]}),a.images.length>0&&e.jsxs("span",{className:"bg-gradient-to-r from-purple-100 to-pink-100 text-purple-700 px-3 py-1 rounded-full text-xs font-semibold border border-purple-200 flex items-center gap-1",children:[e.jsx(Z,{className:"h-3 w-3"}),"1 Image"]})]})]}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>ae(a.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 h-9 w-9 p-0 shrink-0 rounded-lg border border-red-200",children:e.jsx(Ce,{className:"h-4 w-4"})})]})},a.id))})]})]})]}),e.jsxs(ce,{className:"p-6 pt-4 border-t bg-gradient-to-r from-gray-50 via-slate-50 to-gray-50 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-600",children:u==="yes"&&d.length>0&&e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4 text-green-600"}),e.jsxs("span",{children:[e.jsx("strong",{children:d.length})," variation stock",d.length!==1?"s":""," ready to submit"]})]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(m,{variant:"outline",onClick:w,className:"h-11 px-8 font-semibold border-2",children:"Cancel"}),e.jsxs(m,{onClick:ee,className:"bg-gradient-to-r from-green-600 via-emerald-600 to-teal-600 hover:from-green-700 hover:via-emerald-700 hover:to-teal-700 text-white h-11 px-10 shadow-lg shadow-green-300 font-bold text-base",disabled:u==="yes"&&d.length===0,children:[e.jsx(K,{className:"h-5 w-5 mr-2"}),u==="yes"?`Submit ${d.length} Stock${d.length!==1?"s":""}`:"Add Stock to Inventory"]})]})]})]})})},Re=({isOpen:I,onClose:w,variations:r,onSuccess:D})=>{const[y,T]=n.useState({variation_id:"",name:""}),[_,L]=n.useState(!1),[B,E]=n.useState(!1),[u,k]=n.useState(""),d=async()=>{var c,V;if(!u.trim()){i.error("Please enter variation type name");return}L(!0);try{const b=await ge.post("/api/variations",{name:u});b.data.status==="success"?(i.success("Variation type created successfully"),D(),k(""),E(!1)):i.error(b.data.message||"Failed to create variation type")}catch(b){console.error("Error creating variation type:",b),i.error(((V=(c=b.response)==null?void 0:c.data)==null?void 0:V.message)||"Failed to create variation type")}finally{L(!1)}},S=async()=>{var c,V;if(!y.variation_id||!y.name){i.error("Please fill in all fields");return}L(!0);try{const b=await ge.post("/api/variation-options",{variation_id:parseInt(y.variation_id),name:y.name});b.data.status==="success"?(i.success("Variation option created successfully"),D(),w(),T({variation_id:"",name:""})):i.error(b.data.message||"Failed to create variation")}catch(b){console.error("Error creating variation:",b),i.error(((V=(c=b.response)==null?void 0:c.data)==null?void 0:V.message)||"Failed to create variation")}finally{L(!1)}};return e.jsx(ie,{open:I,onOpenChange:w,children:e.jsxs(ne,{className:"sm:max-w-[450px] max-h-[90vh] flex flex-col p-0 gap-0 rounded-2xl bg-white",children:[e.jsx(le,{className:"p-6 pb-4 border-b bg-gray-50/50 shrink-0",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx(re,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx(oe,{className:"text-xl",children:"New Variation Option"}),e.jsx(xe,{className:"text-gray-500 mt-1",children:"Add a new option to an existing variation type."})]})]})}),e.jsxs("div",{className:"p-6 space-y-6 bg-white overflow-y-auto flex-1",children:[e.jsxs("div",{className:"space-y-4",children:[B?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"New Variation Type"}),e.jsxs(m,{variant:"ghost",size:"sm",onClick:()=>{E(!1),k("")},className:"h-7 px-2 text-xs",children:[e.jsx(Y,{className:"h-3 w-3 mr-1"}),"Cancel"]})]}),e.jsx(f,{placeholder:"e.g. Color, Size, Material",className:"h-11 bg-white border-gray-200 focus:border-green-500 transition-all",value:u,onChange:c=>k(c.target.value),onKeyDown:c=>c.key==="Enter"&&d()}),e.jsx(m,{onClick:d,disabled:_,className:"w-full bg-green-600 hover:bg-green-700 h-10",children:_?"Creating...":"Create Variation Type"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Variation Type"}),e.jsxs(m,{variant:"ghost",size:"sm",onClick:()=>E(!0),className:"h-7 px-2 text-xs text-green-600 hover:text-green-700 hover:bg-green-50",children:[e.jsx(G,{className:"h-3 w-3 mr-1"}),"New Type"]})]}),e.jsxs(ke,{value:y.variation_id,onValueChange:c=>T({...y,variation_id:c}),children:[e.jsx(Ve,{className:"h-11 bg-white border-gray-200 focus:border-green-500 transition-all",children:e.jsx(Pe,{placeholder:"Select type (e.g. Color, Size)"})}),e.jsx(Fe,{className:"bg-white",children:r.map(c=>e.jsx(Ie,{value:c.id.toString(),children:c.name},c.id))})]})]}),!B&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Option Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(Me,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(f,{placeholder:"e.g. Red, XL, Cotton",className:"pl-9 h-11 bg-white border-gray-200 focus:border-green-500 transition-all",value:y.name,onChange:c=>T({...y,name:c.target.value}),onKeyDown:c=>c.key==="Enter"&&S()})]})]})]}),e.jsxs("div",{className:"bg-blue-50/50 border border-blue-100 rounded-lg p-3 text-sm text-blue-700 flex gap-2",children:[e.jsx("div",{className:"shrink-0 mt-0.5",children:e.jsx("div",{className:"h-4 w-4 rounded-full bg-blue-200 flex items-center justify-center text-[10px] font-bold text-blue-700",children:"i"})}),e.jsx("p",{children:"Creating a new option will make it available for all products using this variation type."})]})]}),e.jsxs(ce,{className:"p-6 pt-4 border-t bg-gray-50/50",children:[e.jsx(m,{variant:"outline",onClick:w,className:"h-11 px-6",children:"Close"}),!B&&e.jsx(m,{onClick:S,disabled:_,className:"bg-green-600 hover:bg-green-700 h-11 px-6 shadow-sm shadow-green-200",children:_?"Creating...":"Create Option"})]})]})})},ps=()=>{const[I,w]=n.useState([]),[r,D]=n.useState(!0),[y,T]=n.useState(""),[_,L]=n.useState(null),[B,E]=n.useState([]),[u,k]=n.useState([]),[d,S]=n.useState([]),[c,V]=n.useState([]),[b,A]=n.useState(!1),[p,C]=n.useState(!1),[g,N]=n.useState(!1),[l,j]=n.useState({name:"",slug:"",image:null});n.useEffect(()=>{U(),q(),H(),$(),X()},[]);const U=async()=>{D(!0);try{const s=await be(y);s.status==="success"&&w(s.data)}catch(s){console.error("Error fetching products:",s),i.error("Failed to load products")}finally{D(!1)}},q=async()=>{try{const s=await fe(!0);s.status==="success"&&E(s.data)}catch(s){console.error("Error fetching variations:",s)}},H=async()=>{try{const s=await ye();s.status==="success"&&k(s.data)}catch(s){console.error("Error fetching parent variations:",s)}},$=async()=>{try{const s=await je();s.status==="success"&&S(s.data)}catch(s){console.error("Error fetching brands:",s)}},X=async()=>{try{const s=await ve();s.status==="success"&&V(s.data)}catch(s){console.error("Error fetching categories:",s)}},R=s=>{if(!s.stocks||s.stocks.length===0)return"짜0.00";const O=s.stocks.map(Q=>{const J=parseFloat(Q.web_price),a=parseFloat(Q.web_discount);return J-a}),P=Math.min(...O),z=Math.max(...O);return P===z?`짜${P.toFixed(2)}`:`짜${P.toFixed(2)} - 짜${z.toFixed(2)}`},ee=s=>{s.preventDefault(),U()},se=s=>{L(s),A(!0)},ae=async()=>{try{const s=new FormData;s.append("name",l.name),s.append("slug",l.slug),l.image&&s.append("image",l.image),(await Ne(s)).status==="success"&&(i.success("Brand created successfully"),$(),N(!1),j({name:"",slug:"",image:null}))}catch{i.error("Failed to create brand")}};return e.jsxs(ue,{children:[e.jsx(pe,{title:"Add Existing Product"}),e.jsxs("div",{className:"space-y-8 max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Product Catalog"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Browse the global catalog and add products to your inventory."})]})}),e.jsxs("form",{onSubmit:ee,className:"relative max-w-2xl",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(De,{className:"h-5 w-5 text-gray-400"})}),e.jsx(f,{placeholder:"Search by product name, brand, or category...",className:"pl-11 h-12 text-lg bg-white shadow-sm border-gray-200 focus:border-green-500 focus:ring-green-500 rounded-xl",value:y,onChange:s=>T(s.target.value)}),e.jsx("div",{className:"absolute inset-y-0 right-2 flex items-center",children:e.jsx(m,{type:"submit",size:"sm",className:"bg-green-600 hover:bg-green-700 text-white rounded-lg px-4",children:"Search"})})]}),r?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx(Le,{className:"h-10 w-10 animate-spin text-green-600 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Loading products..."})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:I.map(s=>{var O,P;return e.jsxs("div",{className:"group bg-white rounded-2xl border border-gray-100 shadow-sm hover:shadow-md transition-all duration-200 overflow-hidden flex flex-col h-full",children:[e.jsxs("div",{className:"aspect-[4/3] bg-gray-50 relative overflow-hidden",children:[e.jsx("img",{src:`/${s.primary_image}`,alt:s.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",onError:z=>{z.target.src="https://placehold.co/400?text=No+Image"}}),e.jsx("div",{className:"absolute top-3 left-3",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-white/90 text-gray-700 backdrop-blur-sm shadow-sm",children:((O=s.category)==null?void 0:O.name)||"Uncategorized"})})]}),e.jsxs("div",{className:"p-5 flex-1 flex flex-col",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h3",{className:"font-bold text-gray-900 line-clamp-1 text-lg group-hover:text-green-600 transition-colors",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:(P=s.brand)==null?void 0:P.name})]}),e.jsxs("div",{className:"mt-auto pt-4 border-t border-gray-50 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Price Range:"}),e.jsx("span",{className:"ml-1 font-semibold text-gray-900",children:R(s)})]}),e.jsxs(m,{size:"sm",className:"bg-gray-900 text-white hover:bg-green-600 transition-colors rounded-lg",onClick:()=>se(s),children:["Select",e.jsx(Ee,{className:"ml-1.5 h-3.5 w-3.5"})]})]})]})]},s.id)})}),!r&&I.length===0&&e.jsxs("div",{className:"text-center py-20 bg-gray-50 rounded-2xl border border-dashed border-gray-200",children:[e.jsx(W,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No products found"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Try adjusting your search terms or check back later."})]})]}),e.jsx($e,{isOpen:b,onClose:()=>A(!1),product:_,onSuccess:()=>{q()},setIsVariationModalOpen:C,setIsBrandModalOpen:N,groupedVariations:B,brands:d,categories:c,isNew:!1}),e.jsx(Re,{isOpen:p,onClose:()=>C(!1),variations:u,onSuccess:()=>{q(),H()}}),e.jsx(ie,{open:g,onOpenChange:N,children:e.jsxs(ne,{className:"bg-white",children:[e.jsx(le,{children:e.jsx(oe,{children:"Create Brand"})}),e.jsxs("div",{className:"space-y-4 py-4 bg-white",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Brand Name"}),e.jsx(f,{placeholder:"Brand Name",value:l.name,onChange:s=>j({...l,name:s.target.value,slug:s.target.value.toLowerCase().replace(/\s+/g,"-")})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Slug"}),e.jsx(f,{placeholder:"brand-slug",value:l.slug,onChange:s=>j({...l,slug:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Logo"}),e.jsx(f,{type:"file",onChange:s=>s.target.files&&j({...l,image:s.target.files[0]})})]})]}),e.jsxs(ce,{children:[e.jsx(m,{variant:"outline",onClick:()=>N(!1),children:"Cancel"}),e.jsx(m,{onClick:ae,children:"Create"})]})]})})]})};export{ps as default};
