import{r,f as n,t as d,j as e,H as $}from"./app-Dmq_v5yT.js";import{S as ee}from"./SellerLayout-yR8nWqMp.js";import{B as j}from"./button-DSfbffQ8.js";import{I as y,L as o}from"./label-BqwrHOzj.js";import{B as I}from"./badge-CIdxytjo.js";import{D as ae,a as se,b as te,c as re,e as ie,d as le}from"./dialog-C5VgILUB.js";import{T as ce}from"./textarea-DXmjj6yG.js";import{S as L,a as k,b as T,c as B,d as U}from"./select-Dh9zNCBQ.js";import{D as de,a as oe,b as ne,c as M}from"./dropdown-menu-CVgMBWG6.js";import{C as me}from"./checkbox-DG2toD8p.js";import{S as he}from"./search-BGzyKUZI.js";import{L as b}from"./loader-circle-C4PZnu-O.js";import{P as pe}from"./SellerSidebar-BbhqYCMZ.js";import{E as xe}from"./ellipsis-vertical-B28AjPTg.js";import{P as ge}from"./pencil-Be-KRgGE.js";import{T as ue}from"./trash-2-9lDAIQyx.js";import"./createLucideIcon-DZc_IOCv.js";import"./index-D4-owJlT.js";import"./index-BPaTVwo6.js";import"./index-B7Ubbbks.js";import"./index-CW-dqnj-.js";import"./tslib.es6-BKH_Rm7U.js";import"./index-B_r_iSOo.js";import"./index-O9yTcPhN.js";import"./index-b4boaPSw.js";import"./auth-DiJPeYeS.js";const Qe=()=>{const[A,O]=r.useState([]),[V,f]=r.useState(!0),[m,H]=r.useState(""),[R,h]=r.useState(!1),[N,w]=r.useState(null),[Q,q]=r.useState([]),[z,W]=r.useState([]),[v,x]=r.useState(null),[S,C]=r.useState(null),[p,_]=r.useState(null),[g,P]=r.useState(!1),[t,c]=r.useState({name:"",description:"",category_id:"",brand_id:"",web_availability:!1});r.useEffect(()=>{u(),G(),J()},[]);const u=async()=>{try{f(!0);const a=await n.get("/api/products",{params:{with:"product",limit:1e3}});a.data.status==="success"&&O(a.data.data)}catch(a){console.error("Failed to fetch products",a),d.error("Failed to load products")}finally{f(!1)}},G=async()=>{try{const a=await n.get("/api/categories");a.data.status==="success"&&q(a.data.data)}catch(a){console.error("Error fetching categories:",a)}},J=async()=>{try{const a=await n.get("/api/brands");a.data.status==="success"&&W(a.data.data)}catch(a){console.error("Error fetching brands:",a)}},K=a=>{w(a),c({name:a.name,description:a.description,category_id:a.category_id.toString(),brand_id:a.brand_id.toString(),web_availability:a.web_availability}),x(a.primary_image?"/"+a.primary_image:null),h(!0)},X=a=>{if(a.target.files&&a.target.files[0]){const i=a.target.files[0];C(i),x(URL.createObjectURL(i))}},Y=async a=>{var i,l;if(a.preventDefault(),!!N){P(!0);try{const s=new FormData;s.append("id",N.id.toString()),s.append("name",t.name),s.append("description",t.description),s.append("category_id",t.category_id),s.append("brand_id",t.brand_id),s.append("web_availability",t.web_availability?"1":"0"),S&&s.append("primary_image",S);const E=await n.post("/api/products/update",s,{headers:{"Content-Type":"multipart/form-data"}});E.data.status==="success"?(d.success("Product updated successfully"),h(!1),u(),D()):d.error(E.data.message||"Failed to update product")}catch(s){console.error("Update error:",s),d.error(((l=(i=s.response)==null?void 0:i.data)==null?void 0:l.message)||"Failed to update product")}finally{P(!1)}}},Z=async a=>{var i,l;if(confirm("Are you sure you want to delete this product? This action cannot be undone.")){_(a);try{const s=await n.delete("/api/products",{data:{id:a}});s.data.status==="success"?(d.success("Product deleted successfully"),u()):d.error(s.data.errors||s.data.message||"Failed to delete product")}catch(s){console.error("Delete error:",s),d.error(((l=(i=s.response)==null?void 0:i.data)==null?void 0:l.errors)||"Failed to delete product")}finally{_(null)}}},D=()=>{w(null),c({name:"",description:"",category_id:"",brand_id:"",web_availability:!1}),x(null),C(null)},F=A.filter(a=>a.name.toLowerCase().includes(m.toLowerCase())||a.description.toLowerCase().includes(m.toLowerCase()));return e.jsxs(ee,{children:[e.jsx($,{title:"Manage Products | Seller Center"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Manage Products"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Edit or delete your products"})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx(he,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(y,{placeholder:"Search products...",className:"pl-9 bg-white",value:m,onChange:a=>H(a.target.value)})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 font-medium border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3",children:"Product"}),e.jsx("th",{className:"px-6 py-3",children:"Category"}),e.jsx("th",{className:"px-6 py-3",children:"Brand"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:V?e.jsx("tr",{children:e.jsxs("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:[e.jsx(b,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"Loading products..."]})}):F.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-500",children:[e.jsx(pe,{className:"w-10 h-10 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium text-gray-900",children:"No products found"}),e.jsx("p",{children:m?"Try a different search term":"Create your first product to get started"})]})}):F.map(a=>{var i,l;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-16 w-16 flex-shrink-0 bg-gray-100 rounded-md overflow-hidden border border-gray-200",children:e.jsx("img",{src:a.primary_image?"/"+a.primary_image:"https://via.placeholder.com/64?text=No+Image",alt:a.name,className:"h-full w-full object-cover",onError:s=>{s.target.src="https://via.placeholder.com/64?text=No+Img"}})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:a.name}),e.jsx("div",{className:"text-gray-500 text-xs truncate max-w-xs",children:a.description})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(I,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:((i=a.category)==null?void 0:i.name)||"N/A"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(I,{variant:"outline",className:"bg-purple-50 text-purple-700 border-purple-200",children:((l=a.brand)==null?void 0:l.name)||"N/A"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs(de,{children:[e.jsx(oe,{asChild:!0,children:e.jsx(j,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-500",disabled:p===a.id,children:p===a.id?e.jsx(b,{className:"h-4 w-4 animate-spin"}):e.jsx(xe,{className:"h-4 w-4"})})}),e.jsxs(ne,{align:"end",className:"bg-white",children:[e.jsxs(M,{onClick:()=>K(a),disabled:p!==null,children:[e.jsx(ge,{className:"w-4 h-4 mr-2"})," Edit"]}),e.jsxs(M,{className:"text-red-600",onClick:()=>Z(a.id),disabled:p!==null,children:[e.jsx(ue,{className:"w-4 h-4 mr-2"})," Delete"]})]})]})})]},a.id)})})]})})]})]}),e.jsx(ae,{open:R,onOpenChange:h,children:e.jsxs(se,{className:"max-w-3xl bg-white",children:[e.jsxs(te,{children:[e.jsx(re,{children:"Edit Product"}),e.jsx(ie,{children:"Update the product details below."})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto py-4",children:e.jsxs("form",{id:"edit-product-form",onSubmit:Y,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"image",children:"Product Image"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[v&&e.jsx("div",{className:"w-full h-40 bg-gray-100 rounded-md overflow-hidden border border-gray-200",children:e.jsx("img",{src:v,alt:"Preview",className:"w-full h-full object-cover"})}),e.jsx(y,{id:"image",type:"file",accept:"image/*",onChange:X,className:"cursor-pointer bg-white"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(o,{htmlFor:"name",children:"Product Name"}),e.jsx(y,{id:"name",required:!0,value:t.name,onChange:a=>c({...t,name:a.target.value}),placeholder:"Product Name",className:"bg-white"})]}),e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(o,{htmlFor:"description",children:"Description"}),e.jsx(ce,{id:"description",value:t.description,onChange:a=>c({...t,description:a.target.value}),placeholder:"Product description...",className:"h-24 bg-white"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"category",children:"Category"}),e.jsxs(L,{value:t.category_id,onValueChange:a=>c({...t,category_id:a}),children:[e.jsx(k,{className:"bg-white",children:e.jsx(T,{placeholder:"Select category"})}),e.jsx(B,{className:"bg-white",children:Q.map(a=>e.jsx(U,{value:a.id.toString(),children:a.name},a.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"brand",children:"Brand"}),e.jsxs(L,{value:t.brand_id,onValueChange:a=>c({...t,brand_id:a}),children:[e.jsx(k,{className:"bg-white",children:e.jsx(T,{placeholder:"Select brand"})}),e.jsx(B,{className:"bg-white",children:z.map(a=>e.jsx(U,{value:a.id.toString(),children:a.name},a.id))})]})]}),e.jsxs("div",{className:"col-span-2 flex items-center space-x-2",children:[e.jsx(me,{id:"web_availability",checked:t.web_availability,onCheckedChange:a=>c({...t,web_availability:a}),className:"data-[state=checked]:bg-green-600 data-[state=checked]:border-green-600"}),e.jsx(o,{htmlFor:"web_availability",className:"text-sm font-medium cursor-pointer",children:"Available on Web Store"})]})]})]})}),e.jsxs(le,{children:[e.jsx(j,{variant:"outline",onClick:()=>{h(!1),D()},disabled:g,children:"Cancel"}),e.jsxs(j,{form:"edit-product-form",type:"submit",disabled:g,className:"bg-green-600 hover:bg-green-700 text-white",children:[g?e.jsx(b,{className:"w-4 h-4 animate-spin mr-2"}):null,"Update Product"]})]})]})})]})};export{Qe as default};
