import{r as t,e as p,t as l,j as e,L as Q}from"./app-CfNo4LyL.js";import{S as z}from"./SellerLayout-BKQ2vRRh.js";import{B as f}from"./button-DYS6W9m3.js";import{I as g,L as j}from"./label-DA-TjnO8.js";import{D as H,a as V,b as G,c as J,e as K,d as W}from"./dialog-BX1goVUx.js";import{D as X,a as Y,b as Z,c as U}from"./dropdown-menu-T0cWpx2O.js";import{S as _}from"./search-BBDX3mxB.js";import{L as y}from"./loader-circle-CZePyrvB.js";import{L as $}from"./SellerSidebar-Cto75vpQ.js";import{E as ee}from"./ellipsis-vertical-BsfGofvx.js";import{P as se}from"./pencil-SwrZqg9E.js";import{T as ae}from"./trash-2-Z6fLCdYn.js";import"./createLucideIcon-ha3u4Tcd.js";import"./index-CRPvz72I.js";import"./index-Do2vMDzp.js";import"./index-COVW5kEW.js";import"./tslib.es6-BUas5LQb.js";import"./index-Cl-KLhKS.js";import"./index-ljWjQthQ.js";import"./auth-BpSFxXD-.js";const ve=()=>{const[M,T]=t.useState([]),[P,N]=t.useState(!0),[n,k]=t.useState(""),[O,c]=t.useState(!1),[b,w]=t.useState(null),[v,h]=t.useState(null),[C,S]=t.useState(null),[d,D]=t.useState(null),[x,L]=t.useState(!1),[i,m]=t.useState({name:"",slug:""});t.useEffect(()=>{u()},[]);const u=async()=>{try{N(!0);const s=await p.get("/api/categories");s.data.status==="success"&&T(s.data.data)}catch(s){console.error("Failed to fetch categories",s),l.error("Failed to load categories")}finally{N(!1)}},R=s=>{w(s),m({name:s.name,slug:s.slug}),h(s.image?"/"+s.image:null),c(!0)},q=s=>{if(s.target.files&&s.target.files[0]){const r=s.target.files[0];S(r),h(URL.createObjectURL(r))}},A=async s=>{var r,o;if(s.preventDefault(),!!b){L(!0);try{const a=new FormData;a.append("id",b.id.toString()),a.append("name",i.name),a.append("slug",i.slug),C&&a.append("image",C);const E=await p.post("/api/categories/update",a,{headers:{"Content-Type":"multipart/form-data"}});E.data.status==="success"?(l.success("Category updated successfully"),c(!1),u(),I()):l.error(E.data.message||"Failed to update category")}catch(a){console.error("Update error:",a),l.error(((o=(r=a.response)==null?void 0:r.data)==null?void 0:o.message)||"Failed to update category")}finally{L(!1)}}},B=async s=>{var r,o;if(confirm("Are you sure you want to delete this category? This action cannot be undone.")){D(s);try{const a=await p.delete("/api/categories",{data:{id:s}});a.data.status==="success"?(l.success("Category deleted successfully"),u()):l.error(a.data.errors||"Failed to delete category")}catch(a){console.error("Delete error:",a),l.error(((o=(r=a.response)==null?void 0:r.data)==null?void 0:o.errors)||"Failed to delete category")}finally{D(null)}}},I=()=>{w(null),m({name:"",slug:""}),h(null),S(null)},F=M.filter(s=>s.name.toLowerCase().includes(n.toLowerCase())||s.slug.toLowerCase().includes(n.toLowerCase()));return e.jsxs(z,{children:[e.jsx(Q,{title:"Manage Categories | Seller Center"}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Manage Categories"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Edit or delete your categories"})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"relative max-w-sm",children:[e.jsx(_,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(g,{placeholder:"Search categories...",className:"pl-9 bg-white",value:n,onChange:s=>k(s.target.value)})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 font-medium border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3",children:"Category"}),e.jsx("th",{className:"px-6 py-3",children:"Slug"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:P?e.jsx("tr",{children:e.jsxs("td",{colSpan:3,className:"px-6 py-8 text-center text-gray-500",children:[e.jsx(y,{className:"w-6 h-6 animate-spin mx-auto mb-2"}),"Loading categories..."]})}):F.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:3,className:"px-6 py-12 text-center text-gray-500",children:[e.jsx($,{className:"w-10 h-10 mx-auto mb-3 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium text-gray-900",children:"No categories found"}),e.jsx("p",{children:n?"Try a different search term":"Create your first category to get started"})]})}):F.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-16 w-16 flex-shrink-0 bg-gray-100 rounded-md overflow-hidden border border-gray-200",children:e.jsx("img",{src:s.image?"/"+s.image:"https://via.placeholder.com/64?text=No+Image",alt:s.name,className:"h-full w-full object-cover",onError:r=>{r.target.src="https://via.placeholder.com/64?text=No+Img"}})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",s.id]})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("code",{className:"text-sm bg-gray-100 px-2 py-1 rounded text-gray-700",children:s.slug})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs(X,{children:[e.jsx(Y,{asChild:!0,children:e.jsx(f,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-500",disabled:d===s.id,children:d===s.id?e.jsx(y,{className:"h-4 w-4 animate-spin"}):e.jsx(ee,{className:"h-4 w-4"})})}),e.jsxs(Z,{align:"end",className:"bg-white",children:[e.jsxs(U,{onClick:()=>R(s),disabled:d!==null,children:[e.jsx(se,{className:"w-4 h-4 mr-2"})," Edit"]}),e.jsxs(U,{className:"text-red-600",onClick:()=>B(s.id),disabled:d!==null,children:[e.jsx(ae,{className:"w-4 h-4 mr-2"})," Delete"]})]})]})})]},s.id))})]})})]})]}),e.jsx(H,{open:O,onOpenChange:c,children:e.jsxs(V,{className:"max-w-2xl bg-white",children:[e.jsxs(G,{children:[e.jsx(J,{children:"Edit Category"}),e.jsx(K,{children:"Update the category details below."})]}),e.jsx("div",{className:"max-h-[60vh] overflow-y-auto py-4",children:e.jsxs("form",{id:"edit-category-form",onSubmit:A,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"image",children:"Category Image"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[v&&e.jsx("div",{className:"w-full h-40 bg-gray-100 rounded-md overflow-hidden border border-gray-200",children:e.jsx("img",{src:v,alt:"Preview",className:"w-full h-full object-cover"})}),e.jsx(g,{id:"image",type:"file",accept:"image/*",onChange:q,className:"cursor-pointer bg-white"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(j,{htmlFor:"name",children:"Category Name"}),e.jsx(g,{id:"name",required:!0,value:i.name,onChange:s=>m({...i,name:s.target.value}),placeholder:"Category Name",className:"bg-white"})]}),e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(j,{htmlFor:"slug",children:"Slug"}),e.jsx(g,{id:"slug",required:!0,value:i.slug,onChange:s=>m({...i,slug:s.target.value}),placeholder:"category-slug",className:"bg-white"}),e.jsx("p",{className:"text-xs text-gray-500",children:'URL-friendly version of the name (e.g., "my-category")'})]})]})]})}),e.jsxs(W,{children:[e.jsx(f,{variant:"outline",onClick:()=>{c(!1),I()},disabled:x,children:"Cancel"}),e.jsxs(f,{form:"edit-category-form",type:"submit",disabled:x,className:"bg-green-600 hover:bg-green-700 text-white",children:[x?e.jsx(y,{className:"w-4 h-4 animate-spin mr-2"}):null,"Update Category"]})]})]})})]})};export{ve as default};
