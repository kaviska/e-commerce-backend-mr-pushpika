import{r as n,G as de,j as e,t as d}from"./app-qpV6NWqw.js";import{N as me,F as xe,h as ge}from"./Footer-_GOLdPPi.js";import{c as R,P as ue,Q as he,g as pe,a as fe}from"./QuickViewModal-Di5EeMrA.js";import{C as ye,s as be,f as je,c as ve,d as Ne,F as we,D as ke,A as Se,E as Ce,G as Pe,H as U,I as Re,J as _e}from"./index-DCrF5SiW.js";import{a as H}from"./auth-CMvdZPx9.js";import"./logo-D38OwFmG.js";const B=async g=>(await H.get(`/products/${g}/reviews`)).data.data,Fe=async g=>(await H.post("/reviews",g)).data,Le=({slug:g})=>{var W;const[r,M]=n.useState(null),[_,z]=n.useState([]),[G,F]=n.useState(!0),[f,j]=n.useState(""),[I,J]=n.useState([]),[p,v]=n.useState(1),[y,K]=n.useState("description"),[N,A]=n.useState({}),[l,w]=n.useState(null),[u,k]=n.useState(null),[x,E]=n.useState([]),[S,$]=n.useState(0),[O,q]=n.useState(""),[L,T]=n.useState(!1),[X,Y]=n.useState(!1),[Z,D]=n.useState(!1),[ee,te]=n.useState(null),[se,C]=n.useState(!1),b=de.useRef(null),Q=t=>{if(b.current){const s=t==="left"?b.current.scrollLeft-300:b.current.scrollLeft+300;b.current.scrollTo({left:s,behavior:"smooth"})}},P=t=>{D(!0),setTimeout(()=>{j(t),D(!1)},200)};n.useEffect(()=>{g&&(async()=>{var a;F(!0);try{const s=await pe(g);if(s){M(s);const i=[s.primary_image];if(s.stocks.forEach(o=>{o.variation_stocks.forEach(c=>{c.image&&c.image!=="storage/images/products/placeholder.jpg"&&!i.includes(c.image)&&i.push(c.image)})}),J(i),j(s.primary_image),s.stocks.length>0){const o=s.stocks[0],c={};o.variation_stocks.forEach(m=>{const ce=m.variation_option.variation.name;c[ce]=m.variation_option.id}),A(c),w(o),k(R([o]));const h=(a=o.variation_stocks.find(m=>m.image&&m.image!=="storage/images/products/placeholder.jpg"))==null?void 0:a.image;h&&j(h)}if(s.category_id){const o=await fe(s.category_id);z(o.filter(c=>c.id!==s.id))}}}catch(s){console.error("Error loading product:",s),d.error("Failed to load product details")}finally{F(!1)}})()},[g]),n.useEffect(()=>{const t=localStorage.getItem("token");Y(!!t)},[]),n.useEffect(()=>{r!=null&&r.id&&B(r.id).then(E).catch(console.error)},[r==null?void 0:r.id]);const ae=async t=>{var a,s;if(t.preventDefault(),!!r){if(S===0){d.error("Please select a rating");return}T(!0);try{await Fe({product_id:r.id,rating:S,comment:O}),d.success("Review submitted successfully"),$(0),q("");const i=await B(r.id);E(i)}catch(i){d.error(((s=(a=i.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to submit review")}finally{T(!1)}}},re=(t,a)=>{var i;const s={...N,[t]:a};if(A(s),r){const o=r.stocks.find(c=>{const h={};return c.variation_stocks.forEach(m=>{h[m.variation_option.variation.name]=m.variation_option.id}),Object.keys(s).every(m=>h[m]===s[m])});if(o){w(o),k(R([o])),v(1);const c=(i=o.variation_stocks.find(h=>h.image&&h.image!=="storage/images/products/placeholder.jpg"))==null?void 0:i.image;c?P(c):r.primary_image&&P(r.primary_image)}else w(null),k(null)}},V=t=>{l&&(t==="inc"&&p<l.quantity?v(a=>a+1):t==="dec"&&p>1&&v(a=>a-1))},ie=async()=>{var a,s;if(!l){d.error("Please select valid options");return}if(!localStorage.getItem("token")){d.error("Please login to add items to cart"),setTimeout(()=>{window.location.href="/login?redirect_with=product/"+g},1500);return}try{d.loading("Adding to cart..."),await ge(l.id,p),d.dismiss(),d.success(`Added ${p} ${r==null?void 0:r.name} to cart!`,{action:{label:"View Cart",onClick:()=>window.location.href="/cart"}})}catch(i){d.dismiss(),console.error("Error adding to cart:",i),d.error(((s=(a=i.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to add to cart")}},ne=(t=0)=>Array.from({length:5},(a,s)=>e.jsx(U,{className:`w-4 h-4 ${s<Math.floor(t)?"text-yellow-400 fill-current":"text-gray-300"}`},s)),oe=()=>{if(!r)return{};const t={};return r.stocks.forEach(a=>{a.variation_stocks.forEach(s=>{const i=s.variation_option.variation.name,o={id:s.variation_option.id,name:s.variation_option.name};t[i]||(t[i]=[]),t[i].find(c=>c.id===o.id)||t[i].push(o)})}),t};if(G)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(ye,{className:"w-8 h-8 animate-spin text-primary"})});if(!r)return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Product Not Found"}),e.jsx("a",{href:"/products",className:"text-primary hover:underline",children:"Back to Products"})]});const le=oe();return e.jsxs("div",{className:"min-h-screen bg-gray-50 font-sans",children:[e.jsx(me,{}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("nav",{className:"flex text-sm text-gray-500 mb-8 overflow-x-auto whitespace-nowrap pb-2",children:[e.jsx("a",{href:"/",className:"hover:text-primary",children:"Home"}),e.jsx("span",{className:"mx-2",children:"/"}),e.jsx("a",{href:"/products",className:"hover:text-primary",children:"Products"}),e.jsx("span",{className:"mx-2",children:"/"}),r.category?e.jsx("a",{href:`/products?category_ids[]=${r.category.id}`,className:"hover:text-primary cursor-pointer",children:r.category.name}):e.jsx("span",{className:"text-gray-500",children:"Uncategorized"}),e.jsx("span",{className:"mx-2",children:"/"}),e.jsx("span",{className:"text-gray-900 font-medium",children:r.name})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden mb-12",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-0 lg:gap-8",children:[e.jsxs("div",{className:"p-6 lg:p-8 bg-gray-50/50",children:[e.jsxs("div",{className:"relative aspect-square rounded-xl overflow-hidden bg-white mb-4 shadow-sm border border-gray-100 group",children:[e.jsx("img",{src:f?f.startsWith("http")||f.startsWith("/")?f:`/${f}`:"/storage/images/products/placeholder.jpg",alt:r.name,className:`w-full h-full object-contain mix-blend-multiply group-hover:scale-105 transition-all duration-300 ${Z?"opacity-0 scale-95":"opacity-100 scale-100"}`,onError:t=>{const a=t.target;a.src="/storage/images/products/placeholder.jpg"}}),(u==null?void 0:u.discountPercentage)>0&&e.jsxs("div",{className:"absolute top-4 left-4 bg-red-500 text-white px-3 py-1 rounded-full text-sm font-bold shadow-sm",children:["-",u.discountPercentage,"%"]})]}),I.length>0&&e.jsx("div",{className:"grid grid-cols-5 gap-3",children:I.map((t,a)=>e.jsx("button",{onClick:()=>P(t),className:`aspect-square rounded-lg overflow-hidden border-2 transition-all ${f===t?"border-primary ring-2 ring-primary/20":"border-transparent hover:border-gray-300"} bg-white`,children:e.jsx("img",{src:t.startsWith("http")||t.startsWith("/")?t:`/${t}`,alt:"",className:"w-full h-full object-cover",onError:s=>{const i=s.target;i.src="/storage/images/products/placeholder.jpg"}})},a))})]}),e.jsxs("div",{className:"p-6 lg:p-8 flex flex-col",children:[e.jsx("div",{className:"mb-1",children:e.jsx("span",{className:"text-sm font-medium text-primary uppercase tracking-wider",children:(W=r.brand)==null?void 0:W.name})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4 leading-tight",children:r.name}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[ne(x.length>0?x.reduce((t,a)=>t+a.rating,0)/x.length:0),e.jsx("span",{className:"text-sm font-medium text-gray-900 ml-2",children:x.length>0?(x.reduce((t,a)=>t+a.rating,0)/x.length).toFixed(1):"0.0"})]}),e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[x.length," Reviews"]}),e.jsx("span",{className:"text-gray-300",children:"|"}),l&&l.quantity>0?e.jsxs("span",{className:"text-sm text-green-600 font-medium flex items-center gap-1",children:[e.jsx(be,{className:"w-4 h-4"})," In Stock (",l.quantity,")"]}):e.jsxs("span",{className:"text-sm text-red-500 font-medium flex items-center gap-1",children:[e.jsx(je,{className:"w-4 h-4"})," Out of Stock"]})]}),e.jsx("div",{className:"flex items-baseline gap-4 mb-8",children:u?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-4xl font-bold text-gray-900",children:["$",u.price.toFixed(2)]}),u.originalPrice&&e.jsxs("span",{className:"text-xl text-gray-400 line-through",children:["$",u.originalPrice.toFixed(2)]})]}):e.jsx("span",{className:"text-2xl text-gray-400",children:"Unavailable"})}),e.jsx("p",{className:"text-gray-600 mb-8 leading-relaxed line-clamp-4",children:r.description}),e.jsxs("div",{className:"space-y-6 border-t border-gray-100 pt-6 mb-8",children:[Object.entries(le).map(([t,a])=>{var s;return e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:[t,": ",e.jsx("span",{className:"text-gray-500 font-normal",children:(s=a.find(i=>i.id===N[t]))==null?void 0:s.name})]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:a.map(i=>e.jsx("button",{onClick:()=>re(t,i.id),className:`px-4 py-2 rounded-lg border-2 text-sm font-medium transition-all ${N[t]===i.id?"border-primary bg-primary/5 text-primary":"border-gray-200 hover:border-gray-300 text-gray-600"}`,children:i.name},i.id))})]},t)}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex items-center border border-gray-300 rounded-xl w-fit",children:[e.jsx("button",{onClick:()=>V("dec"),className:"p-3 hover:bg-gray-50 text-gray-600 transition-colors rounded-l-xl disabled:opacity-50",disabled:p<=1||!l,children:e.jsx(ve,{className:"w-4 h-4"})}),e.jsx("span",{className:"w-12 text-center font-medium text-gray-900",children:p}),e.jsx("button",{onClick:()=>V("inc"),className:"p-3 hover:bg-gray-50 text-gray-600 transition-colors rounded-r-xl disabled:opacity-50",disabled:!l||p>=l.quantity,children:e.jsx(Ne,{className:"w-4 h-4"})})]}),e.jsxs("button",{onClick:ie,disabled:!l||l.quantity===0,className:`flex-1 py-3 px-8 rounded-xl font-bold flex items-center justify-center gap-2 transition-all ${l&&l.quantity>0?"bg-primary text-white hover:bg-primary-600 shadow-lg shadow-primary/25 hover:shadow-xl hover:-translate-y-0.5":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[e.jsx(we,{className:"w-5 h-5"}),l&&l.quantity>0?"Add to Cart":"Out of Stock"]}),e.jsx("button",{className:"p-3 border border-gray-300 rounded-xl hover:bg-gray-50 text-gray-600 transition-colors",children:e.jsx(ke,{className:"w-6 h-6"})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx(Se,{className:"w-6 h-6 text-primary"}),e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Free Shipping"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx(Ce,{className:"w-6 h-6 text-primary"}),e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Secure Payment"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx(Pe,{className:"w-6 h-6 text-primary"}),e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Easy Returns"})]})]})]})]}),e.jsxs("div",{className:"border-t border-gray-100",children:[e.jsx("div",{className:"flex border-b border-gray-100 overflow-x-auto",children:["description","specifications","reviews"].map(t=>e.jsxs("button",{onClick:()=>K(t),className:`px-8 py-4 text-sm font-medium capitalize transition-colors relative whitespace-nowrap ${y===t?"text-primary":"text-gray-500 hover:text-gray-700"}`,children:[t,y===t&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary"})]},t))}),e.jsxs("div",{className:"p-8 bg-gray-50/30",children:[y==="description"&&e.jsx("div",{className:"prose max-w-none text-gray-600",children:e.jsx("p",{children:r.description})}),y==="specifications"&&e.jsx("div",{className:"text-gray-500 italic",children:"No specifications available."}),y==="reviews"&&e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx("div",{className:"space-y-8 mb-12",children:x.length>0?x.map(t=>e.jsxs("div",{className:"border-b border-gray-100 pb-8 last:border-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-500 font-bold",children:t.user.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900",children:t.user.name}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(t.created_at).toLocaleDateString()})]})]}),e.jsx("div",{className:"flex text-yellow-400",children:Array.from({length:5}).map((a,s)=>e.jsx(U,{className:`w-4 h-4 ${s<t.rating?"fill-current":"text-gray-300"}`},s))})]}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:t.comment})]},t.id)):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No reviews yet. Be the first to review!"})}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-xl border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-6",children:"Write a Review"}),X?e.jsxs("form",{onSubmit:ae,children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rating"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(t=>e.jsx("button",{type:"button",onClick:()=>$(t),className:`text-2xl transition-colors ${S>=t?"text-yellow-400":"text-gray-300 hover:text-yellow-200"}`,children:"â˜…"},t))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Review"}),e.jsx("textarea",{value:O,onChange:t=>q(t.target.value),className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all",rows:4,placeholder:"Share your thoughts about this product...",required:!0})]}),e.jsx("button",{type:"submit",disabled:L,className:"px-8 py-3 bg-primary text-white rounded-lg font-medium hover:bg-primary-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:L?"Submitting...":"Submit Review"})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Please log in to write a review."}),e.jsx("a",{href:"/login",className:"text-primary font-medium hover:underline",children:"Log In"})]})]})]})]})]})]}),_.length>0&&e.jsxs("div",{className:"mb-12 relative group/slider",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Related Products"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Q("left"),className:"p-2 rounded-full border border-gray-200 hover:bg-gray-50 text-gray-600 transition-colors",children:e.jsx(Re,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>Q("right"),className:"p-2 rounded-full border border-gray-200 hover:bg-gray-50 text-gray-600 transition-colors",children:e.jsx(_e,{className:"w-5 h-5"})})]})]}),e.jsx("div",{ref:b,className:"flex gap-6 overflow-x-auto pb-8 snap-x snap-mandatory scrollbar-hide -mx-4 px-4 sm:mx-0 sm:px-0",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:_.map(t=>{var i,o;const a=R(t.stocks),s={id:t.id,name:t.name,slug:t.slug,image:t.primary_image||"https://via.placeholder.com/300",images:[t.primary_image],price:a.price,originalPrice:a.originalPrice,rating:0,reviewCount:0,category:((i=t.category)==null?void 0:i.name)||"",brand:(o=t.brand)==null?void 0:o.name,inStock:a.inStock,stockCount:a.stockCount,isOnSale:(a.discount||0)>0,discount:a.discount,discountPercentage:a.discountPercentage,priceRange:a.priceRange,originalPriceRange:a.originalPriceRange};return e.jsx("div",{className:"min-w-[280px] w-[280px] snap-start",children:e.jsx(ue,{product:s,variant:"compact",onQuickView:()=>{te(s),C(!0)}})},t.id)})})]})]}),e.jsx(he,{isOpen:se,onClose:()=>C(!1),product:ee,onAddToCart:t=>{d.success(`Added product ${t} to cart`),C(!1)}}),e.jsx(xe,{})]})};export{Le as default};
