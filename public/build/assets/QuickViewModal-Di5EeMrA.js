import{r as u,j as e,t as j}from"./app-qpV6NWqw.js";import{D as te,u as ae,H as T,N as B,O as se,P as ie,e as ne,C as U,s as re,f as oe,c as le,d as ce,F as de}from"./index-DCrF5SiW.js";import{i as me,h as ge}from"./Footer-_GOLdPPi.js";import{a as I}from"./auth-CMvdZPx9.js";const Ne=({product:t,variant:l="default",showQuickActions:s=!0,onAddToCart:w,onAddToWishlist:c,onQuickView:x})=>{var z;const[b,C]=u.useState(0),[N,_]=u.useState(!1),{isInWishlist:d,toggleWishlist:S}=me(),[r,g]=u.useState(d(t.id));u.useEffect(()=>{g(d(t.id))},[t.id,d]);const h=t.images||[t.image],y=t.discountPercentage??(t.discount&&t.originalPrice?Math.round(t.discount/t.originalPrice*100):0),E=m=>{m.stopPropagation(),m.preventDefault();const k=S({id:t.id,name:t.name,slug:t.slug||"",primary_image:t.image,category_name:t.category,brand_name:t.brand,price:t.price,discount:y});g(k),k?j.success(`${t.name} added to wishlist`):j.info(`${t.name} removed from wishlist`),c==null||c(t.id)},P=m=>{m.stopPropagation(),m.preventDefault(),x==null||x(t.id)},M=()=>{const m=t.reviews_avg_rating??t.rating??0;return Array.from({length:5},(k,F)=>e.jsx(T,{className:`w-3 h-3 ${F<Math.floor(m)?"text-yellow-400 fill-current":"text-gray-300"}`},F))},O=()=>{const m=[];return t.isOnSale||y>0?m.push({text:`-${y}%`,className:"bg-red-500 text-white"}):t.isNew&&m.push({text:"NEW",className:"bg-blue-500 text-white"}),m},A=`
    group relative bg-white rounded-xl transition-all duration-300 
    hover:-translate-y-1 overflow-hidden border border-gray-100 h-full flex flex-col
    ${N?"shadow-lg ring-1 ring-black/5":"shadow-sm"}
  `;return e.jsxs("a",{href:t.slug?`/product/${t.slug}`:"#",className:A,onMouseEnter:()=>_(!0),onMouseLeave:()=>_(!1),children:[e.jsxs("div",{className:"relative aspect-square bg-gray-50 overflow-hidden",children:[e.jsx("div",{className:"absolute top-2 left-2 z-10 flex flex-col gap-1",children:O().map((m,k)=>e.jsx("span",{className:`px-1.5 py-0.5 rounded text-[10px] font-bold tracking-wide ${m.className}`,children:m.text},k))}),e.jsx("button",{onClick:E,className:`absolute top-2 right-2 z-10 p-1.5 rounded-full transition-all duration-200 ${r?"bg-red-500 text-white shadow-lg":"bg-white/80 text-gray-400 hover:text-red-500 hover:bg-white opacity-0 group-hover:opacity-100"} ${r?"opacity-100":""}`,children:e.jsx(te,{className:`w-4 h-4 ${r?"fill-current":""}`})}),e.jsx("img",{src:h[b]?h[b].startsWith("http")||h[b].startsWith("/")?h[b]:`/${h[b]}`:"/storage/images/products/placeholder.jpg",alt:t.name,className:"w-full h-full object-cover object-center group-hover:scale-105 transition-transform duration-500",onError:m=>{const k=m.target;k.src="/storage/images/products/placeholder.jpg"}}),e.jsx("div",{className:`absolute inset-x-0 bottom-0 p-3 bg-gradient-to-t from-black/40 to-transparent flex justify-center transition-opacity duration-200 ${N?"opacity-100":"opacity-100 md:opacity-0 md:group-hover:opacity-100"}`,children:e.jsxs("button",{onClick:P,className:"bg-white text-gray-900 px-4 py-2 rounded-lg text-xs font-bold hover:bg-gray-50 transition-colors shadow-sm flex items-center gap-2",children:[e.jsx(ae,{className:"w-3 h-3"}),"Quick View"]})})]}),e.jsxs("div",{className:"p-3 flex-grow flex flex-col",children:[e.jsx("div",{className:"text-[10px] text-gray-500 mb-1 uppercase tracking-wider font-medium truncate",children:t.category}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-1 line-clamp-2 leading-tight group-hover:text-primary transition-colors min-h-[2.5em]",children:t.name}),e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:"flex space-x-0.5 mr-1",children:M()}),e.jsxs("span",{className:"text-[10px] text-gray-400",children:["(",t.reviews_count??t.reviewCount??0,")"]})]}),e.jsx("div",{className:"mt-auto flex items-center justify-between pt-2 border-t border-gray-50",children:e.jsx("div",{className:"flex flex-col",children:e.jsxs("div",{className:"flex items-baseline gap-1.5",children:[e.jsx("span",{className:"text-base font-bold text-gray-900",children:t.priceRange?e.jsx("span",{children:t.priceRange}):e.jsxs(e.Fragment,{children:["$",t.price.toFixed(0),e.jsxs("span",{className:"text-xs align-top",children:[".",(t.price%1).toFixed(2).substring(2)]})]})}),(t.originalPriceRange||t.originalPrice)&&e.jsx("span",{className:"text-xs text-gray-400 line-through",children:t.originalPriceRange||`$${(z=t.originalPrice)==null?void 0:z.toFixed(0)}`})]})})})]})]})},ke=async(t={})=>{var w,c;const l=new URLSearchParams;return l.append("with","all"),l.append("limit","100000"),(w=t.category_ids)!=null&&w.length&&t.category_ids.forEach(x=>l.append("category_ids[]",x.toString())),(c=t.brand_ids)!=null&&c.length&&t.brand_ids.forEach(x=>l.append("brand_ids[]",x.toString())),t.web_price_min!==void 0&&l.append("web_price_min",t.web_price_min.toString()),t.web_price_max!==void 0&&l.append("web_price_max",t.web_price_max.toString()),t.in_stock&&l.append("in_stock","1"),t.has_web_discount&&l.append("has_web_discount","1"),t.search&&l.append("search",t.search),(await I.get(`/products?${l.toString()}`)).data},he=async t=>{const l=await I.get(`/products?slug=${t}&with=all`);return l.data.status==="success"&&l.data.data.length>0?l.data.data[0]:null},_e=async t=>(await I.get(`/products?category_ids[]=${t}&limit=10&with=all`)).data.data||[],Se=async()=>(await I.get("/categories?limit=10000")).data,Pe=async()=>(await I.get("/brands?limit=10000")).data,Q=t=>{const l=t.reduce((r,g)=>r+g.quantity,0);if(!(l>0))return{price:0,inStock:!1,stockCount:0,priceRange:"Out of Stock"};const w=t.map(r=>{const g=r.web_price,h=r.web_discount||0,y=g*h/100,E=g-y;return{original:g,selling:E,discount:y,discountPercent:h}}),c=w.map(r=>r.selling),x=Math.min(...c),b=Math.max(...c),C=w.map(r=>r.original),N=Math.min(...C),_=Math.max(...C);if(t.length===1||x===b){const r=w.find(h=>h.selling===x),g=r.discountPercent;return{price:r.selling,originalPrice:r.discountPercent>0?r.original:void 0,discount:r.discount,discountPercentage:g,inStock:!0,stockCount:l}}const d=w.some(r=>r.discountPercent>0),S=w.reduce((r,g)=>g.discountPercent>r?g.discountPercent:r,0);return{price:x,priceRange:`$${x} - $${b}`,originalPriceRange:d?`$${N} - $${_}`:void 0,inStock:!0,stockCount:l,discount:d?N-x:0,discountPercentage:S}};function xe(t){return B({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"},child:[]}]})(t)}function ue(t){return B({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"},child:[]}]})(t)}function pe(t){return B({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"},child:[]}]})(t)}const $e=({isOpen:t,onClose:l,product:s,onAddToCart:w})=>{const[c,x]=u.useState(null),[b,C]=u.useState(!1),[N,_]=u.useState({}),[d,S]=u.useState(null),[r,g]=u.useState(null),[h,y]=u.useState(1),[E,P]=u.useState(""),[M,O]=u.useState([]);u.useEffect(()=>{t&&(s!=null&&s.slug)?A(s.slug):(x(null),C(!1),_({}),S(null),g(null),y(1),O([]),P(""))},[t,s]);const A=async a=>{var o;C(!0);try{const n=await he(a);if(n){x(n);const i=[n.primary_image];if(n.stocks.forEach(p=>{p.variation_stocks.forEach(f=>{f.image&&f.image!=="storage/images/products/placeholder.jpg"&&!i.includes(f.image)&&i.push(f.image)})}),O(i),P(n.primary_image),n.stocks.length>0){const p=n.stocks[0],f={};p.variation_stocks.forEach(v=>{const ee=v.variation_option.variation.name;f[ee]=v.variation_option.id}),_(f),S(p),g(Q([p]));const $=(o=p.variation_stocks.find(v=>v.image&&v.image!=="storage/images/products/placeholder.jpg"))==null?void 0:o.image;$&&P($)}}}catch(n){console.error("Error loading product details:",n),j.error("Failed to load product details")}finally{C(!1)}},z=(a,o)=>{var p;if(!c)return;const n={...N,[a]:o};_(n);const i=c.stocks.find(f=>{const $={};return f.variation_stocks.forEach(v=>{$[v.variation_option.variation.name]=v.variation_option.id}),Object.keys(n).every(v=>$[v]===n[v])});if(i){S(i),g(Q([i])),y(1);const f=(p=i.variation_stocks.find($=>$.image&&$.image!=="storage/images/products/placeholder.jpg"))==null?void 0:p.image;f?P(f):c.primary_image&&P(c.primary_image)}else S(null),g(null)},m=a=>{d&&(a==="inc"&&h<d.quantity?y(o=>o+1):a==="dec"&&h>1&&y(o=>o-1))},k=async()=>{var o,n;if(!d){j.error("Please select valid options");return}if(!localStorage.getItem("token")){j.error("Please login to add items to cart"),setTimeout(()=>{window.location.href="/login"},1500);return}try{j.loading("Adding to cart..."),await ge(d.id,h),j.dismiss(),j.success("Added product to cart!",{action:{label:"View Cart",onClick:()=>window.location.href="/cart"}}),w&&w(d.id),l()}catch(i){j.dismiss(),console.error("Error adding to cart:",i),j.error(((n=(o=i.response)==null?void 0:o.data)==null?void 0:n.message)||"Failed to add to cart")}},[F,D]=u.useState(!1),[fe,be]=u.useState({top:0,left:0}),G=async a=>{if(a.stopPropagation(),s!=null&&s.slug){const o=`${window.location.origin}/product/${s.slug}`,n=s.name,i=`Check out ${s.name} on Nippon Cars!`;if(navigator.share)try{await navigator.share({title:n,text:i,url:o});return}catch(p){console.log("Error sharing:",p),p.name!=="AbortError"&&V()}else V()}},V=()=>{D(!F)},R=a=>{if(!(s!=null&&s.slug))return;const o=encodeURIComponent(`${window.location.origin}/product/${s.slug}`),n=encodeURIComponent(`Check out ${s.name} on our store!`);let i="";switch(a){case"facebook":i=`https://www.facebook.com/sharer/sharer.php?u=${o}`,window.open(i,"_blank","width=600,height=400");break;case"twitter":i=`https://twitter.com/intent/tweet?url=${o}&text=${n}`,window.open(i,"_blank","width=600,height=400");break;case"whatsapp":i=`https://wa.me/?text=${n}%20${o}`,window.open(i,"_blank");break;case"copy":navigator.clipboard.writeText(`${window.location.origin}/product/${s.slug}`),j.success("Link copied to clipboard");break}D(!1)};u.useEffect(()=>{const a=()=>D(!1);return F&&window.addEventListener("click",a),()=>window.removeEventListener("click",a)},[F]);const X=()=>{if(!c)return{};const a={};return c.stocks.forEach(o=>{o.variation_stocks.forEach(n=>{const i=n.variation_option.variation.name,p={id:n.variation_option.id,name:n.variation_option.name};a[i]||(a[i]=[]),a[i].find(f=>f.id===p.id)||a[i].push(p)})}),a},J=()=>{const a=c?c.reviews_avg_rating||0:(s==null?void 0:s.rating)||0;return Array.from({length:5},(o,n)=>e.jsx(T,{className:`w-4 h-4 ${n<Math.floor(a)?"text-yellow-400 fill-current":"text-gray-300"}`},n))};if(!t||!s)return null;const K=X(),L=E||s.image,Y=r?r.price:s.price,H=r?r.originalPrice:s.originalPrice,q=r?r.discountPercentage:s.discountPercentage,W=d?d.quantity>0:s.inStock,Z=d?d.quantity:s.stockCount;return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:l}),e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-4xl overflow-hidden flex flex-col md:flex-row h-[90vh] md:h-auto md:max-h-[600px] animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"absolute top-4 right-4 z-10 flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:G,className:"p-2 bg-white/80 rounded-full hover:bg-white transition-colors",title:"Share Product",children:e.jsx(se,{className:"w-5 h-5 text-gray-500"})}),F&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-xl border border-gray-100 py-1 z-50 animate-in fade-in zoom-in-95 duration-100",onClick:a=>a.stopPropagation(),children:[e.jsxs("button",{onClick:()=>R("facebook"),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-3 text-gray-700",children:[e.jsx(xe,{className:"w-4 h-4 text-[#1877F2]"})," Facebook"]}),e.jsxs("button",{onClick:()=>R("twitter"),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-3 text-gray-700",children:[e.jsx(ue,{className:"w-4 h-4 text-[#1DA1F2]"})," Twitter"]}),e.jsxs("button",{onClick:()=>R("whatsapp"),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-3 text-gray-700",children:[e.jsx(pe,{className:"w-4 h-4 text-[#25D366]"})," WhatsApp"]}),e.jsx("div",{className:"border-t border-gray-100 my-1"}),e.jsxs("button",{onClick:()=>R("copy"),className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-3 text-gray-700",children:[e.jsx(ie,{className:"w-4 h-4 text-gray-500"})," Copy Link"]})]})]}),e.jsx("button",{onClick:l,className:"p-2 bg-white/80 rounded-full hover:bg-white transition-colors",children:e.jsx(ne,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"w-full md:w-1/2 bg-gray-50 p-4 md:p-6 flex flex-col items-center justify-center relative flex-shrink-0",children:[b?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50/80 z-10",children:e.jsx(U,{className:"w-8 h-8 animate-spin text-primary"})}):null,e.jsx("div",{className:"relative w-full h-48 md:h-auto md:aspect-square max-w-sm mx-auto mb-4",children:e.jsx("img",{src:L.startsWith("http")||L.startsWith("/")?L:`/${L}`,alt:s.name,className:"w-full h-full object-contain mix-blend-multiply",onError:a=>{const o=a.target;o.src="/storage/images/products/placeholder.jpg"}})}),M.length>1&&e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 w-full justify-center",children:M.map((a,o)=>e.jsx("button",{onClick:()=>P(a),className:`w-16 h-16 border-2 rounded-lg overflow-hidden flex-shrink-0 ${E===a?"border-primary":"border-transparent hover:border-gray-300"}`,children:e.jsx("img",{src:a.startsWith("http")||a.startsWith("/")?a:`/${a}`,alt:"",className:"w-full h-full object-cover",onError:n=>{const i=n.target;i.src="/storage/images/products/placeholder.jpg"}})},o))})]}),e.jsxs("div",{className:"w-full md:w-1/2 p-6 md:p-8 overflow-y-auto relative",children:[b&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80 z-20",children:e.jsx(U,{className:"w-8 h-8 animate-spin text-primary"})}),e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-xs font-bold text-primary uppercase tracking-wider bg-primary/10 px-2 py-1 rounded",children:s.category}),s.brand&&e.jsx("span",{className:"ml-2 text-xs font-medium text-gray-500",children:s.brand})]}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:s.name}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex mr-2",children:J()}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",(c==null?void 0:c.reviews_count)||s.reviewCount," reviews)"]})]}),e.jsxs("div",{className:"flex items-baseline gap-3 mb-6",children:[e.jsxs("span",{className:"text-3xl font-bold text-gray-900",children:["$",Y.toFixed(2)]}),H&&e.jsxs("span",{className:"text-lg text-gray-400 line-through",children:["$",H.toFixed(2)]}),q&&q>0&&e.jsxs("span",{className:"text-sm font-bold text-red-500 bg-red-50 px-2 py-1 rounded",children:["-",q,"%"]})]}),e.jsx("div",{className:"prose prose-sm text-gray-600 mb-6 line-clamp-4",children:(c==null?void 0:c.description)||s.description||"No description available."}),Object.entries(K).map(([a,o])=>{var n;return e.jsxs("div",{className:"mb-4",children:[e.jsxs("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:[a,": ",e.jsx("span",{className:"text-gray-500 font-normal",children:(n=o.find(i=>i.id===N[a]))==null?void 0:n.name})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:o.map(i=>e.jsx("button",{onClick:()=>z(a,i.id),className:`px-3 py-1.5 rounded-lg border text-sm font-medium transition-all ${N[a]===i.id?"border-primary bg-primary/5 text-primary":"border-gray-200 hover:border-gray-300 text-gray-600"}`,children:i.name},i.id))})]},a)}),e.jsx("div",{className:"flex items-center gap-2 mb-6 mt-4",children:W?e.jsxs("span",{className:"flex items-center text-green-600 text-sm font-medium",children:[e.jsx(re,{className:"mr-1.5"})," In Stock (",Z," available)"]}):e.jsxs("span",{className:"flex items-center text-red-500 text-sm font-medium",children:[e.jsx(oe,{className:"mr-1.5"})," Out of Stock"]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex items-center border border-gray-300 rounded-xl w-fit",children:[e.jsx("button",{onClick:()=>m("dec"),className:"p-3 hover:bg-gray-50 text-gray-600 transition-colors rounded-l-xl disabled:opacity-50",disabled:h<=1||!d,children:e.jsx(le,{className:"w-4 h-4"})}),e.jsx("span",{className:"w-12 text-center font-medium text-gray-900",children:h}),e.jsx("button",{onClick:()=>m("inc"),className:"p-3 hover:bg-gray-50 text-gray-600 transition-colors rounded-r-xl disabled:opacity-50",disabled:!d||h>=(d.quantity||0),children:e.jsx(ce,{className:"w-4 h-4"})})]}),e.jsxs("button",{onClick:k,disabled:!W||b,className:`flex-1 py-3 px-6 rounded-xl font-bold flex items-center justify-center gap-2 transition-all ${W&&!b?"bg-primary text-white hover:bg-primary-600 shadow-lg shadow-primary/25 hover:shadow-xl hover:-translate-y-0.5":"bg-gray-100 text-gray-400 cursor-not-allowed"}`,children:[e.jsx(de,{className:"w-5 h-5"}),W?"Add to Cart":"Out of Stock"]})]})]})]})]})};export{Ne as P,$e as Q,_e as a,Se as b,Q as c,Pe as d,ke as e,he as g};
