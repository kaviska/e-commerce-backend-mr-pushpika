import{r as i,f as p,t as r,j as e,H as Oe}from"./app-CgcuHfcV.js";import{S as Se}from"./SellerLayout-BQ6E32iX.js";import{B as o}from"./button-Cohb5s7o.js";import{I as F,L}from"./label-PlmXA06j.js";import{D as E,a as I,b as U,c as z,e as A,d as T}from"./dialog-BdEab6bY.js";import{a as se,L as ae}from"./SellerSidebar-DiSXodgc.js";import{S as Fe}from"./search-CoFUMz3D.js";import{L as h}from"./loader-circle-gW5wr0i7.js";import{P as te}from"./pencil-Ctx-ePyM.js";import{T as re}from"./trash-2-DLQfhOHB.js";import"./createLucideIcon-L111TtY5.js";import"./index-khSbgmmG.js";import"./index-xVpn745B.js";import"./index-CJQ1CjOf.js";import"./index-Dlg8Dh6T.js";import"./index-DbJ4XrGX.js";import"./tslib.es6-BKH_Rm7U.js";import"./auth-OXswbwCF.js";const Ge=()=>{const[ie,ne]=i.useState([]),[oe,q]=i.useState(!0),[j,le]=i.useState(""),[de,y]=i.useState(!1),[ce,b]=i.useState(!1),[_,H]=i.useState(null),[P,B]=i.useState(null),[D,Q]=i.useState(!1),[V,R]=i.useState(!1),[me,k]=i.useState(!1),[c,pe]=i.useState(null),[G,ue]=i.useState([]),[he,$]=i.useState(!1),[v,x]=i.useState({name:""}),[g,w]=i.useState(null),[J,K]=i.useState(!1),[W,X]=i.useState(!1),[Y,Z]=i.useState(null),xe=s=>{pe(s),k(!0),C(s.id),x({name:""}),w(null)},C=async s=>{try{$(!0);const t=await p.get(`/api/variation-options?variation_id=${s}`);t.data.status==="success"&&ue(t.data.data)}catch(t){console.error("Failed to fetch options",t),r.error("Failed to load options")}finally{$(!1)}},ge=async s=>{var t,n;if(s.preventDefault(),!(!v.name.trim()||!c)){K(!0);try{const a=await p.post("/api/variation-options",{variation_id:c.id,name:v.name});a.data.status==="success"?(r.success("Option added successfully"),x({name:""}),C(c.id)):r.error(a.data.message||"Failed to add option")}catch(a){console.error("Create option error:",a),r.error(((n=(t=a.response)==null?void 0:t.data)==null?void 0:n.message)||"Failed to add option")}finally{K(!1)}}},fe=async s=>{var t,n;if(s.preventDefault(),!(!g||!v.name.trim()||!c)){X(!0);try{const a=await p.put("/api/variation-options",{id:g.id,variation_id:c.id,name:v.name});a.data.status==="success"?(r.success("Option updated successfully"),w(null),x({name:""}),C(c.id)):r.error(a.data.message||"Failed to update option")}catch(a){console.error("Update option error:",a),r.error(((n=(t=a.response)==null?void 0:t.data)==null?void 0:n.message)||"Failed to update option")}finally{X(!1)}}},je=async s=>{var t,n;if(c&&confirm("Are you sure you want to delete this option?")){Z(s);try{const a=await p.delete("/api/variation-options",{data:{id:s}});a.data.status==="success"?(r.success("Option deleted successfully"),C(c.id)):r.error(a.data.message||"Failed to delete option")}catch(a){console.error("Delete option error:",a),r.error(((n=(t=a.response)==null?void 0:t.data)==null?void 0:n.message)||"Failed to delete option")}finally{Z(null)}}},ye=s=>{w(s),x({name:s.name})},ve=()=>{w(null),x({name:""})},[N,O]=i.useState({name:""});i.useEffect(()=>{S()},[]);const S=async()=>{try{q(!0);const s=await p.get("/api/variations");s.data.status==="success"&&ne(s.data.data)}catch(s){console.error("Failed to fetch variations",s),r.error("Failed to load variations")}finally{q(!1)}},Ne=async s=>{var t,n,a,m,d,u;if(s.preventDefault(),!N.name.trim()){r.error("Variation name is required");return}Q(!0);try{const l=await p.post("/api/variations",{name:N.name});l.data.status==="success"?(r.success("Variation created successfully"),y(!1),S(),f()):r.error(l.data.message||"Failed to create variation")}catch(l){console.error("Create error:",l);const M=((m=(a=(n=(t=l.response)==null?void 0:t.data)==null?void 0:n.errors)==null?void 0:a.name)==null?void 0:m[0])||((u=(d=l.response)==null?void 0:d.data)==null?void 0:u.message)||"Failed to create variation";r.error(M)}finally{Q(!1)}},be=s=>{H(s),O({name:s.name}),b(!0)},we=async s=>{var t,n,a,m,d,u;if(s.preventDefault(),!!_){R(!0);try{const l=await p.put("/api/variations",{id:_.id.toString(),name:N.name});l.data.status==="success"?(r.success("Variation updated successfully"),b(!1),S(),f()):r.error(l.data.message||"Failed to update variation")}catch(l){console.error("Update error:",l);const M=((m=(a=(n=(t=l.response)==null?void 0:t.data)==null?void 0:n.errors)==null?void 0:a.name)==null?void 0:m[0])||((u=(d=l.response)==null?void 0:d.data)==null?void 0:u.message)||"Failed to update variation";r.error(M)}finally{R(!1)}}},Ce=async s=>{var t,n,a,m;if(confirm("Are you sure you want to delete this variation? This action cannot be undone.")){B(s);try{const d=await p.delete("/api/variations",{data:{id:s.toString()}});d.data.status==="success"?(r.success("Variation deleted successfully"),S()):r.error(d.data.message||"Failed to delete variation")}catch(d){console.error("Delete error:",d);const u=((n=(t=d.response)==null?void 0:t.data)==null?void 0:n.errors)||((m=(a=d.response)==null?void 0:a.data)==null?void 0:m.message)||"Failed to delete variation";r.error(u)}finally{B(null)}}},f=()=>{H(null),O({name:""})},ee=ie.filter(s=>s.name.toLowerCase().includes(j.toLowerCase()));return e.jsxs(Se,{children:[e.jsx(Oe,{title:"Manage Variations | Seller Center"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Manage Variations"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Create and manage product variations (e.g., Size, Color, Material)"})]}),e.jsxs(o,{onClick:()=>{f(),y(!0)},className:"flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),"Add Variation"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(F,{type:"text",placeholder:"Search variations...",value:j,onChange:s=>le(s.target.value),className:"pl-10"})]}),e.jsx("div",{className:"bg-white rounded-lg border shadow-sm",children:oe?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(h,{className:"w-8 h-8 animate-spin text-primary"})}):ee.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center p-12 text-center",children:[e.jsx(ae,{className:"w-12 h-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:j?"No variations found":"No variations yet"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:j?"Try adjusting your search terms":"Get started by creating your first variation"}),!j&&e.jsxs(o,{onClick:()=>{f(),y(!0)},children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"Add Variation"]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Variation Name"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ee.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"w-5 h-5 text-gray-400 mr-3"}),e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(o,{size:"sm",variant:"outline",onClick:()=>xe(s),className:"text-gray-700 hover:bg-gray-50",children:"Manage Options"}),e.jsx(o,{size:"sm",variant:"ghost",onClick:()=>be(s),className:"text-blue-600 hover:text-blue-900 hover:bg-blue-50",children:e.jsx(te,{className:"w-4 h-4"})}),e.jsx(o,{size:"sm",variant:"ghost",onClick:()=>Ce(s.id),disabled:P===s.id,className:"text-red-600 hover:text-red-900 hover:bg-red-50",children:P===s.id?e.jsx(h,{className:"w-4 h-4 animate-spin"}):e.jsx(re,{className:"w-4 h-4"})})]})})]},s.id))})]})})})]}),e.jsx(E,{open:de,onOpenChange:y,children:e.jsxs(I,{children:[e.jsxs(U,{children:[e.jsx(z,{children:"Create New Variation"}),e.jsx(A,{children:"Add a new product variation like Size, Color, Material, etc."})]}),e.jsxs("form",{onSubmit:Ne,children:[e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(L,{htmlFor:"create-name",children:["Variation Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(F,{id:"create-name",value:N.name,onChange:s=>O({name:s.target.value}),placeholder:"e.g., Size, Color, Material",required:!0})]})}),e.jsxs(T,{children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>{y(!1),f()},disabled:D,children:"Cancel"}),e.jsxs(o,{type:"submit",disabled:D,children:[D&&e.jsx(h,{className:"w-4 h-4 mr-2 animate-spin"}),"Create Variation"]})]})]})]})}),e.jsx(E,{open:ce,onOpenChange:b,children:e.jsxs(I,{children:[e.jsxs(U,{children:[e.jsx(z,{children:"Edit Variation"}),e.jsx(A,{children:"Update the variation name"})]}),e.jsxs("form",{onSubmit:we,children:[e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(L,{htmlFor:"edit-name",children:["Variation Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(F,{id:"edit-name",value:N.name,onChange:s=>O({name:s.target.value}),placeholder:"e.g., Size, Color, Material",required:!0})]})}),e.jsxs(T,{children:[e.jsx(o,{type:"button",variant:"outline",onClick:()=>{b(!1),f()},disabled:V,children:"Cancel"}),e.jsxs(o,{type:"submit",disabled:V,children:[V&&e.jsx(h,{className:"w-4 h-4 mr-2 animate-spin"}),"Update Variation"]})]})]})]})}),e.jsx(E,{open:me,onOpenChange:k,children:e.jsxs(I,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(U,{children:[e.jsxs(z,{children:["Manage Options for ",c==null?void 0:c.name]}),e.jsx(A,{children:"Add or edit options for this variation (e.g., Small, Medium, Large for Size)."})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-4 border",children:[e.jsx("h4",{className:"font-medium text-sm text-gray-900",children:g?"Edit Option":"Add New Option"}),e.jsxs("form",{onSubmit:g?fe:ge,className:"flex gap-4 items-end",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(L,{htmlFor:"option-name",className:"sr-only",children:"Option Name"}),e.jsx(F,{id:"option-name",value:v.name,onChange:s=>x({name:s.target.value}),placeholder:"Option Name (e.g., Red)",required:!0})]}),e.jsxs("div",{className:"flex gap-2",children:[g&&e.jsx(o,{type:"button",variant:"ghost",onClick:ve,children:"Cancel"}),e.jsxs(o,{type:"submit",disabled:J||W,children:[(J||W)&&e.jsx(h,{className:"w-4 h-4 mr-2 animate-spin"}),g?"Update":"Add"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-sm text-gray-900",children:"Existing Options"}),he?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(h,{className:"w-8 h-8 animate-spin text-gray-400"})}):G.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500 border-2 border-dashed rounded-lg",children:"No options added yet."}):e.jsx("div",{className:"border rounded-md divide-y",children:G.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{size:"sm",variant:"ghost",onClick:()=>ye(s),className:"h-8 w-8 p-0 text-blue-600 hover:bg-blue-50",children:e.jsx(te,{className:"w-4 h-4"})}),e.jsx(o,{size:"sm",variant:"ghost",onClick:()=>je(s.id),disabled:Y===s.id,className:"h-8 w-8 p-0 text-red-600 hover:bg-red-50",children:Y===s.id?e.jsx(h,{className:"w-4 h-4 animate-spin"}):e.jsx(re,{className:"w-4 h-4"})})]})]},s.id))})]})]}),e.jsx(T,{children:e.jsx(o,{type:"button",variant:"outline",onClick:()=>k(!1),children:"Close"})})]})})]})};export{Ge as default};
